[{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\axios\\apiEndpoint.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\axios\\axiosConfig.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Comments\\CommentActionModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Comments\\Comments.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Comments\\CommentsTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Comments\\CommentsUtils.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Interactions\\InteractionStats.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Interactions\\Interactions.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Interactions\\InteractionsList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Interactions\\InteractionsUtils.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Messages\\ChatSidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Messages\\ChatWindow.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Messages\\Messages.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'markAsReadMutation'. Either include it or remove the dependency array.","line":38,"column":6,"nodeType":"ArrayExpression","endLine":38,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [markAsReadMutation, selectedChatId]","fix":{"range":[1177,1193],"text":"[markAsReadMutation, selectedChatId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'messages' logical expression could make the dependencies of useEffect Hook (at line 44) change on every render. To fix this, wrap the initialization of 'messages' in its own useMemo() Hook.","line":41,"column":9,"nodeType":"VariableDeclarator","endLine":41,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n  useConversations,\r\n  useMessages,\r\n  useSendMessage,\r\n  useMarkAsRead,\r\n} from '@/hooks/useMessageQuery';\r\nimport toast from 'react-hot-toast';\r\n\r\nimport ChatSidebar from './ChatSidebar';\r\nimport ChatWindow from './ChatWindow';\r\n\r\nconst Messages = () => {\r\n  const { user: currentUser } = useSelector(state => state.auth);\r\n\r\n  const [selectedChat, setSelectedChat] = useState(null);\r\n  const [messageInput, setMessageInput] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const messagesEndRef = useRef(null);\r\n\r\n  const { data: conversationsData, isLoading: conversationsLoading } =\r\n    useConversations({ page: 1, limit: 20 });\r\n\r\n  const selectedChatId = selectedChat?._id || selectedChat?.id;\r\n  const { data: messagesData, isLoading: messagesLoading } = useMessages({\r\n    conversationId: selectedChatId,\r\n    page: 1,\r\n  });\r\n\r\n  const sendMessageMutation = useSendMessage();\r\n  const markAsReadMutation = useMarkAsRead();\r\n\r\n  useEffect(() => {\r\n    if (selectedChatId) {\r\n      markAsReadMutation.mutate(selectedChatId);\r\n    }\r\n  }, [selectedChatId]);\r\n\r\n  // Scroll to bottom\r\n  const messages = messagesData?.messages || messagesData || [];\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages, selectedChat]);\r\n\r\n  const handleSend = async e => {\r\n    e.preventDefault();\r\n    if (!messageInput.trim() || !selectedChatId) return;\r\n\r\n    try {\r\n      await sendMessageMutation.mutateAsync({\r\n        conversationId: selectedChatId,\r\n        content: messageInput,\r\n        type: 'text',\r\n      });\r\n      setMessageInput('');\r\n    } catch (error) {\r\n      toast.error(error?.response?.data?.message || 'G·ª≠i tin nh·∫Øn th·∫•t b·∫°i');\r\n    }\r\n  };\r\n\r\n  const loading = conversationsLoading || messagesLoading;\r\n  const conversations =\r\n    conversationsData?.conversations || conversationsData || [];\r\n\r\n  return (\r\n    <div className=\"h-[calc(100vh-8rem)] bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 flex overflow-hidden shadow-sm\">\r\n      <ChatSidebar\r\n        conversations={conversations}\r\n        loading={loading}\r\n        selectedChat={selectedChat}\r\n        setSelectedChat={setSelectedChat}\r\n        currentUser={currentUser}\r\n        searchTerm={searchTerm}\r\n        setSearchTerm={setSearchTerm}\r\n      />\r\n\r\n      <ChatWindow\r\n        selectedChat={selectedChat}\r\n        setSelectedChat={setSelectedChat}\r\n        messages={messages}\r\n        currentUser={currentUser}\r\n        messageInput={messageInput}\r\n        setMessageInput={setMessageInput}\r\n        handleSend={handleSend}\r\n        messagesEndRef={messagesEndRef}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Messages;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Posts\\PostActionModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Posts\\PostDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Posts\\Posts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Posts\\PostsGrid.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\ReportDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\ReportStats.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\ReportStatusModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\Reports.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\ReportsList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Content\\Reports\\ReportsUtils.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Dashboard\\Dashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'growthLoading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":49,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"growthLoading"},"fix":{"range":[1000,1026],"text":""},"desc":"Remove unused variable 'growthLoading'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from 'react';\nimport {\n  Users,\n  FileText,\n  MessageSquare,\n  Heart,\n  ArrowUpRight,\n  RefreshCcw,\n  Activity,\n  TrendingUp,\n} from 'lucide-react';\n\nimport {\n  useDashboardStats,\n  useUserGrowth,\n  useTopUsers,\n} from '@/hooks/useAdminQuery';\n\nimport UserGrowthChart from './UserGrowthChart';\nimport StatCard from '../Shared/StatCard';\n\nconst Dashboard = () => {\n  const [period, setPeriod] = useState(30);\n\n  const { startDate, endDate } = useMemo(() => {\n    const end = new Date();\n    const start = new Date();\n    start.setDate(end.getDate() - period);\n    return {\n      startDate: start.toISOString(),\n      endDate: end.toISOString(),\n    };\n  }, [period]);\n\n  const {\n    data: stats,\n    isLoading: statsLoading,\n    refetch: refetchStats,\n  } = useDashboardStats();\n\n  const {\n    data: topUsersData,\n    isLoading: usersLoading,\n    refetch: refetchTopUsers,\n  } = useTopUsers(1, 5);\n\n  const topUsers = topUsersData?.users || [];\n\n  const { data: growthData, isLoading: growthLoading } = useUserGrowth(\n    startDate,\n    endDate\n  );\n\n  const handleRefresh = () => {\n    refetchStats();\n    refetchTopUsers();\n  };\n\n  const statCards = [\n    {\n      title: 'T·ªïng ng∆∞·ªùi d√πng',\n      value: stats?.totalUsers?.toLocaleString() || '0',\n      change: '+12.5%',\n      trend: 'up',\n      icon: Users,\n      color: 'primary',\n    },\n    {\n      title: 'B√†i vi·∫øt m·ªõi',\n      value: stats?.totalPosts?.toLocaleString() || '0',\n      change: '+8.2%',\n      trend: 'up',\n      icon: FileText,\n      color: 'success',\n    },\n    {\n      title: 'B√¨nh lu·∫≠n',\n      value: stats?.totalComments?.toLocaleString() || '0',\n      change: '-2.4%',\n      trend: 'down',\n      icon: MessageSquare,\n      color: 'warning',\n    },\n    {\n      title: 'L∆∞·ª£t t∆∞∆°ng t√°c',\n      value: stats?.totalInteractions?.toLocaleString() || '0',\n      change: '+24.5%',\n      trend: 'up',\n      icon: Activity,\n      color: 'danger',\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-neutral-800 dark:text-white\">\n            Xin ch√†o! üëã\n          </h2>\n          <p className=\"text-sm text-neutral-500 dark:text-neutral-400 mt-0.5\">\n            T·ªïng quan ho·∫°t ƒë·ªông h√¥m nay\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <select\n            value={period}\n            onChange={e => setPeriod(Number(e.target.value))}\n            className=\"px-3 py-2 bg-neutral-100 dark:bg-neutral-800 rounded-xl text-sm font-medium text-neutral-700 dark:text-neutral-300 focus:outline-none focus:ring-2 focus:ring-primary/50\"\n          >\n            <option value={7}>7 ng√†y</option>\n            <option value={30}>30 ng√†y</option>\n            <option value={90}>90 ng√†y</option>\n          </select>\n          <button\n            onClick={handleRefresh}\n            className=\"p-2 bg-neutral-100 dark:bg-neutral-800 rounded-xl text-neutral-500 hover:text-neutral-700 dark:hover:text-white transition-colors\"\n          >\n            <RefreshCcw\n              size={18}\n              strokeWidth={1.5}\n              className={statsLoading ? 'animate-spin' : ''}\n            />\n          </button>\n        </div>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n        {statCards.map((stat, index) => (\n          <StatCard\n            key={index}\n            title={stat.title}\n            value={stat.value}\n            icon={stat.icon}\n            change={stat.change}\n            trend={stat.trend}\n            color={stat.color}\n            loading={statsLoading}\n          />\n        ))}\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n        {/* Growth Chart */}\n        <div className=\"lg:col-span-2 bg-white dark:bg-neutral-900 rounded-2xl p-5 shadow-sm\">\n          <div className=\"flex items-center justify-between mb-5\">\n            <div>\n              <h3 className=\"text-base font-semibold text-neutral-800 dark:text-white\">\n                TƒÉng tr∆∞·ªüng ng∆∞·ªùi d√πng\n              </h3>\n              <div className=\"flex items-center gap-2 mt-1\">\n                <span className=\"text-2xl font-semibold text-neutral-800 dark:text-white\">\n                  {growthData?.totalGrowth || 0}\n                </span>\n                <span className=\"text-xs font-medium text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 px-2 py-0.5 rounded-full\">\n                  +{growthData?.percentage || 0}%\n                </span>\n              </div>\n            </div>\n            <div className=\"p-2 bg-violet-50 dark:bg-violet-500/10 rounded-xl\">\n              <TrendingUp\n                size={18}\n                className=\"text-violet-600 dark:text-violet-400\"\n                strokeWidth={1.5}\n              />\n            </div>\n          </div>\n          <div className=\"h-[280px] w-full\">\n            <UserGrowthChart data={growthData?.chartData || []} />\n          </div>\n        </div>\n\n        {/* Top Users */}\n        <div className=\"bg-white dark:bg-neutral-900 rounded-2xl p-5 shadow-sm flex flex-col\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-base font-semibold text-neutral-800 dark:text-white\">\n              Ng∆∞·ªùi d√πng t√≠ch c·ª±c\n            </h3>\n            <button className=\"text-xs font-medium text-violet-600 dark:text-violet-400 hover:underline\">\n              Xem t·∫•t c·∫£\n            </button>\n          </div>\n          <div className=\"flex-1 space-y-3\">\n            {usersLoading\n              ? Array(5)\n                  .fill(0)\n                  .map((_, i) => (\n                    <div\n                      key={i}\n                      className=\"flex items-center gap-3 animate-pulse\"\n                    >\n                      <div className=\"w-9 h-9 rounded-full bg-neutral-100 dark:bg-neutral-800\" />\n                      <div className=\"flex-1\">\n                        <div className=\"h-3.5 w-24 bg-neutral-100 dark:bg-neutral-800 rounded mb-1.5\" />\n                        <div className=\"h-3 w-16 bg-neutral-100 dark:bg-neutral-800 rounded\" />\n                      </div>\n                    </div>\n                  ))\n              : topUsers.map((user, index) => (\n                  <div\n                    key={user._id}\n                    className=\"flex items-center gap-3 p-2 -mx-2 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors cursor-pointer\"\n                  >\n                    <div className=\"relative\">\n                      <img\n                        src={user.avatar || 'https://via.placeholder.com/40'}\n                        alt={user.username}\n                        className=\"w-9 h-9 rounded-full object-cover\"\n                      />\n                      <span className=\"absolute -bottom-0.5 -right-0.5 w-4 h-4 bg-white dark:bg-neutral-900 rounded-full text-[9px] font-bold flex items-center justify-center shadow-sm text-neutral-600 dark:text-neutral-300\">\n                        {index + 1}\n                      </span>\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"text-sm font-medium text-neutral-800 dark:text-white truncate\">\n                        {user.username}\n                      </h4>\n                      <p className=\"text-xs text-neutral-500 truncate\">\n                        {user.email}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-3 text-xs text-neutral-500\">\n                      <span className=\"flex items-center gap-1\">\n                        <FileText size={12} />\n                        {user.postCount || 0}\n                      </span>\n                      <span className=\"flex items-center gap-1\">\n                        <Heart size={12} />\n                        {user.totalLikes || 0}\n                      </span>\n                    </div>\n                  </div>\n                ))}\n          </div>\n          <button className=\"w-full mt-4 py-2.5 rounded-xl bg-neutral-100 dark:bg-neutral-800 text-sm font-medium text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors flex items-center justify-center gap-2\">\n            Xem chi ti·∫øt\n            <ArrowUpRight size={14} />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Dashboard;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Dashboard\\UserGrowthChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Layout\\AdminLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Layout\\Sidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Shared\\AdminTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Shared\\Components.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":357,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":357,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[10722,10737],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { X, AlertTriangle, CheckCircle, Info, AlertCircle } from 'lucide-react';\r\n\r\n/**\r\n * Modal Component\r\n */\r\nexport function Modal({ isOpen, onClose, title, children, size = 'md' }) {\r\n  if (!isOpen) return null;\r\n\r\n  const sizeClasses = {\r\n    sm: 'max-w-sm',\r\n    md: 'max-w-md',\r\n    lg: 'max-w-lg',\r\n    xl: 'max-w-xl',\r\n    '2xl': 'max-w-2xl',\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/30 dark:bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div\r\n        className={`bg-white dark:bg-neutral-900 rounded-2xl w-full ${sizeClasses[size]} border border-neutral-100 dark:border-neutral-800`}\r\n      >\r\n        <div className=\"flex items-center justify-between p-5 border-b border-neutral-100 dark:border-neutral-800\">\r\n          <h2 className=\"text-base font-semibold text-neutral-800 dark:text-white\">\r\n            {title}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-1.5 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors text-neutral-500\"\r\n          >\r\n            <X size={18} />\r\n          </button>\r\n        </div>\r\n        <div className=\"p-5\">{children}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Confirm Modal Component\r\n */\r\nexport function ConfirmModal({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  title,\r\n  message,\r\n  confirmText = 'X√°c nh·∫≠n',\r\n  cancelText = 'H·ªßy',\r\n  type = 'danger',\r\n}) {\r\n  if (!isOpen) return null;\r\n\r\n  const typeConfig = {\r\n    danger: {\r\n      icon: AlertTriangle,\r\n      iconBg: 'bg-rose-50 dark:bg-rose-500/10',\r\n      iconColor: 'text-rose-600 dark:text-rose-400',\r\n      confirmBg: 'bg-rose-600 hover:bg-rose-700',\r\n    },\r\n    warning: {\r\n      icon: AlertCircle,\r\n      iconBg: 'bg-amber-50 dark:bg-amber-500/10',\r\n      iconColor: 'text-amber-600 dark:text-amber-400',\r\n      confirmBg: 'bg-amber-600 hover:bg-amber-700',\r\n    },\r\n    success: {\r\n      icon: CheckCircle,\r\n      iconBg: 'bg-emerald-50 dark:bg-emerald-500/10',\r\n      iconColor: 'text-emerald-600 dark:text-emerald-400',\r\n      confirmBg: 'bg-emerald-600 hover:bg-emerald-700',\r\n    },\r\n    info: {\r\n      icon: Info,\r\n      iconBg: 'bg-blue-50 dark:bg-blue-500/10',\r\n      iconColor: 'text-blue-600 dark:text-blue-400',\r\n      confirmBg: 'bg-blue-600 hover:bg-blue-700',\r\n    },\r\n  };\r\n\r\n  const config = typeConfig[type];\r\n  const Icon = config.icon;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/30 dark:bg-black/50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white dark:bg-neutral-900 rounded-2xl w-full max-w-sm p-5 border border-neutral-100 dark:border-neutral-800\">\r\n        <div className=\"flex items-start gap-3 mb-4\">\r\n          <div className={`p-2.5 rounded-xl ${config.iconBg}`}>\r\n            <Icon size={20} className={config.iconColor} strokeWidth={1.5} />\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <h2 className=\"text-base font-semibold text-neutral-800 dark:text-white\">\r\n              {title}\r\n            </h2>\r\n            <p className=\"text-sm text-neutral-500 dark:text-neutral-400 mt-1\">\r\n              {message}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex gap-2 mt-5\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-1 px-4 py-2.5 rounded-xl border border-neutral-200 dark:border-neutral-700 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors text-sm font-medium text-neutral-700 dark:text-neutral-300\"\r\n          >\r\n            {cancelText}\r\n          </button>\r\n          <button\r\n            onClick={() => {\r\n              onConfirm();\r\n              onClose();\r\n            }}\r\n            className={`flex-1 px-4 py-2.5 rounded-xl text-white transition-colors text-sm font-medium ${config.confirmBg}`}\r\n          >\r\n            {confirmText}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Badge Component\r\n */\r\nexport function Badge({ children, variant = 'default' }) {\r\n  const variants = {\r\n    default:\r\n      'bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-300',\r\n    primary:\r\n      'bg-violet-50 dark:bg-violet-500/10 text-violet-600 dark:text-violet-400',\r\n    success:\r\n      'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400',\r\n    warning:\r\n      'bg-amber-50 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400',\r\n    danger: 'bg-rose-50 dark:bg-rose-500/10 text-rose-600 dark:text-rose-400',\r\n    info: 'bg-blue-50 dark:bg-blue-500/10 text-blue-600 dark:text-blue-400',\r\n  };\r\n\r\n  return (\r\n    <span\r\n      className={`inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium ${variants[variant]}`}\r\n    >\r\n      {children}\r\n    </span>\r\n  );\r\n}\r\n\r\n/**\r\n * Button Component\r\n */\r\nexport function Button({\r\n  children,\r\n  variant = 'primary',\r\n  size = 'md',\r\n  disabled = false,\r\n  loading = false,\r\n  icon: Icon,\r\n  onClick,\r\n  className = '',\r\n  ...props\r\n}) {\r\n  const variants = {\r\n    primary:\r\n      'bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 hover:bg-neutral-800 dark:hover:bg-neutral-100',\r\n    secondary:\r\n      'border border-neutral-200 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800',\r\n    danger: 'bg-rose-600 text-white hover:bg-rose-700',\r\n    success: 'bg-emerald-600 text-white hover:bg-emerald-700',\r\n    ghost:\r\n      'text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800',\r\n  };\r\n\r\n  const sizes = {\r\n    sm: 'px-3 py-1.5 text-xs',\r\n    md: 'px-4 py-2 text-sm',\r\n    lg: 'px-5 py-2.5 text-sm',\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={onClick}\r\n      disabled={disabled || loading}\r\n      className={`inline-flex items-center justify-center gap-2 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${variants[variant]} ${sizes[size]} ${className}`}\r\n      {...props}\r\n    >\r\n      {loading ? (\r\n        <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin\" />\r\n      ) : (\r\n        Icon && <Icon size={size === 'sm' ? 14 : 16} strokeWidth={1.5} />\r\n      )}\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\n\r\n/**\r\n * Input Component\r\n */\r\nexport function Input({ label, error, icon: Icon, className = '', ...props }) {\r\n  return (\r\n    <div className={className}>\r\n      {label && (\r\n        <label className=\"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1.5\">\r\n          {label}\r\n        </label>\r\n      )}\r\n      <div className=\"relative\">\r\n        {Icon && (\r\n          <Icon\r\n            size={16}\r\n            className=\"absolute left-3.5 top-1/2 -translate-y-1/2 text-neutral-400\"\r\n            strokeWidth={1.5}\r\n          />\r\n        )}\r\n        <input\r\n          className={`w-full ${\r\n            Icon ? 'pl-10' : 'pl-4'\r\n          } pr-4 py-2.5 rounded-xl border ${\r\n            error\r\n              ? 'border-rose-400 focus:ring-rose-200'\r\n              : 'border-neutral-200 dark:border-neutral-700 focus:ring-neutral-200 dark:focus:ring-neutral-700'\r\n          } bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-100 text-sm focus:outline-none focus:ring-2 transition-all`}\r\n          {...props}\r\n        />\r\n      </div>\r\n      {error && <p className=\"mt-1 text-xs text-rose-500\">{error}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Select Component\r\n */\r\nexport function Select({ label, options, className = '', ...props }) {\r\n  return (\r\n    <div className={className}>\r\n      {label && (\r\n        <label className=\"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1.5\">\r\n          {label}\r\n        </label>\r\n      )}\r\n      <select\r\n        className=\"w-full px-4 py-2.5 rounded-xl border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-800 text-neutral-800 dark:text-neutral-100 text-sm focus:outline-none focus:ring-2 focus:ring-neutral-200 dark:focus:ring-neutral-700 transition-all\"\r\n        {...props}\r\n      >\r\n        {options.map(option => (\r\n          <option key={option.value} value={option.value}>\r\n            {option.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Toggle Component\r\n */\r\nexport function Toggle({ checked, onChange, label, description }) {\r\n  return (\r\n    <div className=\"flex items-center justify-between\">\r\n      <div>\r\n        {label && (\r\n          <p className=\"font-medium text-black dark:text-white\">{label}</p>\r\n        )}\r\n        {description && (\r\n          <p className=\"text-sm text-neutral-500 dark:text-neutral-400\">\r\n            {description}\r\n          </p>\r\n        )}\r\n      </div>\r\n      <button\r\n        onClick={() => onChange(!checked)}\r\n        className={`relative w-12 h-6 rounded-full transition-colors ${\r\n          checked\r\n            ? 'bg-black dark:bg-white'\r\n            : 'bg-neutral-300 dark:bg-neutral-600'\r\n        }`}\r\n      >\r\n        <div\r\n          className={`absolute top-1 w-4 h-4 rounded-full transition-all ${\r\n            checked ? 'right-1 bg-white dark:bg-black' : 'left-1 bg-white'\r\n          }`}\r\n        />\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Avatar Component\r\n */\r\nexport function Avatar({ src, alt, size = 'md', fallback }) {\r\n  const sizes = {\r\n    sm: 'w-8 h-8',\r\n    md: 'w-10 h-10',\r\n    lg: 'w-12 h-12',\r\n    xl: 'w-16 h-16',\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`${sizes[size]} rounded-full border-2 border-neutral-200 dark:border-neutral-700 overflow-hidden bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center`}\r\n    >\r\n      {src ? (\r\n        <img src={src} alt={alt} className=\"w-full h-full object-cover\" />\r\n      ) : (\r\n        <span className=\"text-neutral-500 dark:text-neutral-400 font-medium\">\r\n          {fallback || alt?.charAt(0)?.toUpperCase()}\r\n        </span>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Card Component\r\n */\r\nexport function Card({ children, className = '', ...props }) {\r\n  return (\r\n    <div\r\n      className={`bg-white dark:bg-neutral-900 rounded-2xl border border-neutral-200 dark:border-neutral-800 ${className}`}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Card Header Component\r\n */\r\nexport function CardHeader({ children, className = '' }) {\r\n  return (\r\n    <div\r\n      className={`p-5 border-b border-neutral-200 dark:border-neutral-700 ${className}`}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Card Content Component\r\n */\r\nexport function CardContent({ children, className = '' }) {\r\n  return <div className={`p-5 ${className}`}>{children}</div>;\r\n}\r\n\r\n/**\r\n * Stat Card Component\r\n */\r\nexport function StatCard({\r\n  title,\r\n  value,\r\n  icon: Icon,\r\n  trend,\r\n  trendValue,\r\n  color = 'neutral',\r\n}) {\r\n  const colors = {\r\n    neutral: {\r\n      iconBg: 'bg-neutral-100 dark:bg-neutral-800',\r\n      iconColor: 'text-neutral-600 dark:text-neutral-400',\r\n    },\r\n    blue: {\r\n      iconBg: 'bg-blue-100 dark:bg-blue-900/30',\r\n      iconColor: 'text-blue-600 dark:text-blue-400',\r\n    },\r\n    green: {\r\n      iconBg: 'bg-green-100 dark:bg-green-900/30',\r\n      iconColor: 'text-green-600 dark:text-green-400',\r\n    },\r\n    red: {\r\n      iconBg: 'bg-red-100 dark:bg-red-900/30',\r\n      iconColor: 'text-red-600 dark:text-red-400',\r\n    },\r\n    yellow: {\r\n      iconBg: 'bg-yellow-100 dark:bg-yellow-900/30',\r\n      iconColor: 'text-yellow-600 dark:text-yellow-400',\r\n    },\r\n    purple: {\r\n      iconBg: 'bg-purple-100 dark:bg-purple-900/30',\r\n      iconColor: 'text-purple-600 dark:text-purple-400',\r\n    },\r\n  };\r\n\r\n  const colorConfig = colors[color];\r\n\r\n  return (\r\n    <Card className=\"p-5\">\r\n      <div className=\"flex items-center justify-between mb-3\">\r\n        <div className={`p-2 rounded-lg ${colorConfig.iconBg}`}>\r\n          <Icon size={20} className={colorConfig.iconColor} />\r\n        </div>\r\n        {trend && (\r\n          <span\r\n            className={`text-sm font-medium ${\r\n              trend === 'up'\r\n                ? 'text-green-600 dark:text-green-400'\r\n                : 'text-red-600 dark:text-red-400'\r\n            }`}\r\n          >\r\n            {trend === 'up' ? '+' : '-'}\r\n            {trendValue}%\r\n          </span>\r\n        )}\r\n      </div>\r\n      <p className=\"text-neutral-500 dark:text-neutral-400 text-sm\">{title}</p>\r\n      <p className=\"text-2xl font-bold text-black dark:text-white mt-1\">\r\n        {value}\r\n      </p>\r\n    </Card>\r\n  );\r\n}\r\n\r\n/**\r\n * Empty State Component\r\n */\r\nexport function EmptyState({ icon: Icon, title, description, action }) {\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\r\n      {Icon && (\r\n        <div className=\"p-4 bg-neutral-100 dark:bg-neutral-800 rounded-full mb-4\">\r\n          <Icon size={32} className=\"text-neutral-400\" />\r\n        </div>\r\n      )}\r\n      <h3 className=\"text-lg font-semibold text-black dark:text-white mb-2\">\r\n        {title}\r\n      </h3>\r\n      {description && (\r\n        <p className=\"text-neutral-500 dark:text-neutral-400 mb-4 max-w-md\">\r\n          {description}\r\n        </p>\r\n      )}\r\n      {action}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Loading Spinner Component\r\n */\r\nexport function Spinner({ size = 'md' }) {\r\n  const sizes = {\r\n    sm: 'w-4 h-4 border-2',\r\n    md: 'w-6 h-6 border-2',\r\n    lg: 'w-8 h-8 border-3',\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`${sizes[size]} border-neutral-300 dark:border-neutral-600 border-t-black dark:border-t-white rounded-full animate-spin`}\r\n    />\r\n  );\r\n}\r\n\r\n/**\r\n * Skeleton Loader Component\r\n */\r\nexport function Skeleton({ className = '' }) {\r\n  return (\r\n    <div\r\n      className={`animate-pulse bg-neutral-200 dark:bg-neutral-700 rounded ${className}`}\r\n    />\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Shared\\StatCard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'iconColorClass' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"iconColorClass"},"fix":{"range":[212,231],"text":""},"desc":"Remove unused variable 'iconColorClass'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { TrendingUp, TrendingDown } from 'lucide-react';\r\n\r\nconst StatCard = ({\r\n  title,\r\n  value,\r\n  icon: Icon,\r\n  change,\r\n  trend,\r\n  loading,\r\n  color = 'neutral',\r\n  iconBgClass,\r\n  iconColorClass,\r\n}) => {\r\n  const colorStyles = {\r\n    neutral:\r\n      'bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-300',\r\n    primary:\r\n      'bg-violet-50 dark:bg-violet-500/10 text-violet-600 dark:text-violet-400',\r\n    success:\r\n      'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400',\r\n    warning:\r\n      'bg-amber-50 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400',\r\n    danger: 'bg-rose-50 dark:bg-rose-500/10 text-rose-600 dark:text-rose-400',\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-neutral-900 rounded-2xl p-5 transition-all hover:bg-neutral-50 dark:hover:bg-neutral-800/50\">\r\n      <div className=\"flex items-start justify-between mb-4\">\r\n        <div\r\n          className={`p-2.5 rounded-xl ${\r\n            iconBgClass ? iconBgClass : colorStyles[color]\r\n          }`}\r\n        >\r\n          {Icon && <Icon size={20} strokeWidth={1.5} />}\r\n        </div>\r\n\r\n        {!loading && change && (\r\n          <div\r\n            className={`flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-full ${\r\n              trend === 'up'\r\n                ? 'bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400'\r\n                : trend === 'down'\r\n                ? 'bg-rose-50 dark:bg-rose-500/10 text-rose-600 dark:text-rose-400'\r\n                : 'bg-neutral-100 dark:bg-neutral-800 text-neutral-500'\r\n            }`}\r\n          >\r\n            {trend === 'up' && <TrendingUp size={12} strokeWidth={2} />}\r\n            {trend === 'down' && <TrendingDown size={12} strokeWidth={2} />}\r\n            {change}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div>\r\n        {loading ? (\r\n          <>\r\n            <div className=\"h-4 w-20 bg-neutral-100 dark:bg-neutral-800 rounded mb-2 animate-pulse\" />\r\n            <div className=\"h-8 w-28 bg-neutral-100 dark:bg-neutral-800 rounded animate-pulse\" />\r\n          </>\r\n        ) : (\r\n          <>\r\n            <p className=\"text-[13px] font-medium text-neutral-500 dark:text-neutral-400 mb-1\">\r\n              {title}\r\n            </p>\r\n            <h3 className=\"text-2xl font-semibold text-neutral-800 dark:text-white tracking-tight\">\r\n              {value}\r\n            </h3>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StatCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\System\\Broadcast.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\System\\Notifications.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":66,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":17},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":76,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":19}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport {\r\n  CheckCircle,\r\n  Clock,\r\n  Trash2,\r\n  RefreshCcw,\r\n  Check,\r\n  Loader2,\r\n  Info,\r\n  AlertTriangle,\r\n  AlertCircle,\r\n  Sparkles,\r\n  Bell,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n} from 'lucide-react';\r\nimport {\r\n  useNotificationsPage,\r\n  useUnreadCount,\r\n  useMarkAsRead,\r\n  useMarkAllAsRead,\r\n  useDeleteNotification,\r\n  useDeleteAllNotifications,\r\n} from '@/hooks/useNotificationQuery';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Notifications = () => {\r\n  const [filterType, setFilterType] = useState('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const LIMIT = 10;\r\n\r\n  // Data Fetching\r\n  const { data, isLoading, isPreviousData, refetch } = useNotificationsPage(\r\n    currentPage,\r\n    LIMIT,\r\n    filterType\r\n  );\r\n\r\n  const { data: unreadCount = 0 } = useUnreadCount();\r\n\r\n  // Mutations\r\n  const { mutate: markAsRead } = useMarkAsRead();\r\n  const { mutate: markAllAsRead } = useMarkAllAsRead();\r\n  const { mutateAsync: deleteNotification } = useDeleteNotification();\r\n  const { mutateAsync: deleteAllNotifications } = useDeleteAllNotifications();\r\n\r\n  // Derived state\r\n  const notifications = data?.notifications || [];\r\n  const pagination = data?.pagination || {};\r\n\r\n  const handleMarkAsRead = id => {\r\n    markAsRead(id);\r\n  };\r\n\r\n  const handleMarkAllAsRead = () => {\r\n    markAllAsRead(undefined, {\r\n      onError: () => toast.error('Kh√¥ng th·ªÉ ƒë√°nh d·∫•u t·∫•t c·∫£ l√† ƒë√£ ƒë·ªçc'),\r\n      onSuccess: () => toast.success('ƒê√£ ƒë√°nh d·∫•u t·∫•t c·∫£ l√† ƒë√£ ƒë·ªçc'),\r\n    });\r\n  };\r\n\r\n  const handleDelete = async id => {\r\n    try {\r\n      await deleteNotification(id);\r\n      toast.success('ƒê√£ x√≥a th√¥ng b√°o');\r\n    } catch (err) {\r\n      toast.error('Kh√¥ng th·ªÉ x√≥a th√¥ng b√°o');\r\n    }\r\n  };\r\n\r\n  const handleDeleteAll = async () => {\r\n    if (window.confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a t·∫•t c·∫£ th√¥ng b√°o kh√¥ng?')) {\r\n      try {\r\n        await deleteAllNotifications();\r\n        toast.success('ƒê√£ x√≥a t·∫•t c·∫£ th√¥ng b√°o');\r\n      } catch (err) {\r\n        toast.error('Kh√¥ng th·ªÉ x√≥a t·∫•t c·∫£ th√¥ng b√°o');\r\n      }\r\n    }\r\n  };\r\n\r\n  const refreshType = () => {\r\n    refetch();\r\n    toast.success('ƒê√£ l√†m m·ªõi th√¥ng b√°o');\r\n  };\r\n\r\n  const getIcon = type => {\r\n    switch (type) {\r\n      case 'info':\r\n        return <Info size={24} className=\"text-blue-500\" />;\r\n      case 'success':\r\n        return <CheckCircle size={24} className=\"text-emerald-500\" />;\r\n      case 'warning':\r\n        return <AlertTriangle size={24} className=\"text-amber-500\" />;\r\n      case 'alert':\r\n        return <AlertCircle size={24} className=\"text-rose-500\" />;\r\n      default:\r\n        return <Sparkles size={24} className=\"text-violet-500\" />;\r\n    }\r\n  };\r\n\r\n  const getTypeLabel = type => {\r\n    const labels = {\r\n      all: 'T·∫•t c·∫£',\r\n      info: 'Th√¥ng tin',\r\n      success: 'Th√†nh c√¥ng',\r\n      warning: 'C·∫£nh b√°o',\r\n      alert: 'L·ªói',\r\n    };\r\n    return labels[type] || type;\r\n  };\r\n\r\n  const getTypeColor = type => {\r\n    switch (type) {\r\n      case 'info':\r\n        return 'bg-blue-50 text-blue-600 border-blue-100';\r\n      case 'success':\r\n        return 'bg-emerald-50 text-emerald-600 border-emerald-100';\r\n      case 'warning':\r\n        return 'bg-amber-50 text-amber-600 border-amber-100';\r\n      case 'alert':\r\n        return 'bg-rose-50 text-rose-600 border-rose-100';\r\n      default:\r\n        return 'bg-neutral-100 text-neutral-600 border-neutral-200';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header Section */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-neutral-900 dark:text-white tracking-tight flex items-center gap-3\">\r\n            <Bell className=\"text-neutral-900 dark:text-white\" size={24} />\r\n            Th√¥ng b√°o h·ªá th·ªëng\r\n          </h2>\r\n          <p className=\"text-sm text-neutral-500 dark:text-neutral-400 mt-1 flex items-center gap-2\">\r\n            B·∫°n c√≥{' '}\r\n            <span className=\"font-bold text-rose-500 bg-rose-50 dark:bg-rose-900/20 px-2 py-0.5 rounded-full border border-rose-100 dark:border-rose-800\">\r\n              {unreadCount}\r\n            </span>{' '}\r\n            th√¥ng b√°o ch∆∞a ƒë·ªçc\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <button\r\n            onClick={refreshType}\r\n            className=\"p-2 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-full text-neutral-500 hover:text-black dark:text-neutral-400 dark:hover:text-white transition-colors\"\r\n            title=\"L√†m m·ªõi\"\r\n          >\r\n            <RefreshCcw size={20} />\r\n          </button>\r\n          <button\r\n            onClick={handleMarkAllAsRead}\r\n            disabled={unreadCount === 0}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 text-neutral-600 dark:text-neutral-300 rounded-full hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-all font-bold text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <Check size={16} />\r\n            <span className=\"hidden sm:inline\">ƒê√°nh d·∫•u t·∫•t c·∫£</span>\r\n          </button>\r\n          <button\r\n            onClick={handleDeleteAll}\r\n            disabled={notifications.length === 0}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-rose-50 dark:bg-rose-900/20 border border-rose-100 dark:border-rose-800 text-rose-600 dark:text-rose-400 rounded-full hover:bg-rose-100 dark:hover:bg-rose-900/30 transition-all font-bold text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <Trash2 size={16} />\r\n            <span className=\"hidden sm:inline\">X√≥a t·∫•t c·∫£</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"overflow-x-auto pb-2 -mx-2 px-2\">\r\n        <div className=\"flex gap-2\">\r\n          {['all', 'info', 'success', 'warning', 'alert'].map(type => (\r\n            <button\r\n              key={type}\r\n              onClick={() => {\r\n                setFilterType(type);\r\n                setCurrentPage(1);\r\n              }}\r\n              className={`px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition-all border ${\r\n                filterType === type\r\n                  ? 'bg-neutral-900 dark:bg-white text-white dark:text-neutral-900 border-neutral-900 dark:border-white'\r\n                  : 'bg-white dark:bg-neutral-900 text-neutral-500 border-neutral-200 dark:border-neutral-800 hover:bg-neutral-50 dark:hover:bg-neutral-800'\r\n              }`}\r\n            >\r\n              {getTypeLabel(type)}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"bg-white dark:bg-neutral-900 rounded-3xl border border-neutral-200 dark:border-neutral-800 shadow-sm overflow-hidden min-h-[400px] flex flex-col\">\r\n        {isLoading ? (\r\n          <div className=\"flex-1 flex flex-col items-center justify-center p-12 text-neutral-400 gap-3\">\r\n            <Loader2\r\n              size={32}\r\n              className=\"animate-spin text-neutral-900 dark:text-white\"\r\n            />\r\n            <span className=\"font-medium\">ƒêang t·∫£i th√¥ng b√°o...</span>\r\n          </div>\r\n        ) : notifications.length === 0 ? (\r\n          <div className=\"flex-1 flex flex-col items-center justify-center p-12 text-center text-neutral-500 gap-4\">\r\n            <div className=\"p-4 bg-neutral-50 dark:bg-neutral-800 rounded-full\">\r\n              <Bell\r\n                size={32}\r\n                className=\"text-neutral-300 dark:text-neutral-600\"\r\n              />\r\n            </div>\r\n            <p className=\"text-lg font-medium text-neutral-900 dark:text-white\">\r\n              Kh√¥ng c√≥ th√¥ng b√°o n√†o\r\n            </p>\r\n            <p className=\"text-sm\">Hi·ªán t·∫°i b·∫°n kh√¥ng c√≥ th√¥ng b√°o m·ªõi n√†o.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"divide-y divide-neutral-100 dark:divide-neutral-800\">\r\n            {notifications.map(notification => (\r\n              <div\r\n                key={notification._id}\r\n                className={`p-5 flex gap-5 transition-all group ${\r\n                  !notification.isRead\r\n                    ? 'bg-blue-50/30 dark:bg-blue-900/10'\r\n                    : 'hover:bg-neutral-50 dark:hover:bg-neutral-800/50'\r\n                }`}\r\n              >\r\n                <div\r\n                  className={`mt-1 flex-shrink-0 p-2.5 rounded-2xl ${getTypeColor(\r\n                    notification.type\r\n                  )} bg-opacity-50`}\r\n                >\r\n                  {getIcon(notification.type)}\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-start justify-between gap-2\">\r\n                    <p\r\n                      className={`text-base leading-snug ${\r\n                        !notification.isRead\r\n                          ? 'font-bold text-neutral-900'\r\n                          : 'font-medium text-neutral-700'\r\n                      }`}\r\n                    >\r\n                      {notification.title}\r\n                    </p>\r\n                    <span className=\"text-xs font-medium text-neutral-400 whitespace-nowrap flex items-center gap-1.5 bg-neutral-50 px-2 py-1 rounded-full border border-neutral-100\">\r\n                      <Clock size={12} />\r\n                      {new Date(notification.createdAt).toLocaleString('vi-VN')}\r\n                    </span>\r\n                  </div>\r\n                  <p className=\"text-sm text-neutral-500 mt-1.5 leading-relaxed\">\r\n                    {notification.message}\r\n                  </p>\r\n                </div>\r\n                <div className=\"flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                  {!notification.isRead && (\r\n                    <button\r\n                      onClick={() => handleMarkAsRead(notification._id)}\r\n                      className=\"p-2 text-blue-500 hover:bg-blue-100 rounded-xl transition-colors bg-white border border-neutral-100 shadow-sm\"\r\n                      title=\"ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc\"\r\n                    >\r\n                      <CheckCircle size={18} />\r\n                    </button>\r\n                  )}\r\n                  <button\r\n                    onClick={() => handleDelete(notification._id)}\r\n                    className=\"p-2 text-neutral-400 hover:text-rose-500 hover:bg-rose-50 rounded-xl transition-colors bg-white border border-neutral-100 shadow-sm\"\r\n                    title=\"X√≥a\"\r\n                  >\r\n                    <Trash2 size={18} />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Pagination */}\r\n      {pagination && pagination.pages > 1 && (\r\n        <div className=\"flex items-center justify-between bg-white p-4 rounded-3xl border border-neutral-100 shadow-sm\">\r\n          <div className=\"text-sm text-neutral-500 px-2\">\r\n            ƒêang hi·ªÉn th·ªã trang{' '}\r\n            <span className=\"font-bold text-neutral-900\">{currentPage}</span> /{' '}\r\n            {pagination.pages}\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              disabled={currentPage === 1 || isLoading}\r\n              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\r\n              className=\"px-4 py-2 rounded-full border border-neutral-200 text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 font-medium text-sm transition-all\"\r\n            >\r\n              <ChevronLeft size={16} />\r\n              Tr∆∞·ªõc\r\n            </button>\r\n            <button\r\n              disabled={\r\n                currentPage >= pagination.pages || isLoading || isPreviousData\r\n              }\r\n              onClick={() => {\r\n                if (!isPreviousData && currentPage < pagination.pages) {\r\n                  setCurrentPage(p => p + 1);\r\n                }\r\n              }}\r\n              className=\"px-4 py-2 rounded-full border border-neutral-200 text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1 font-medium text-sm transition-all\"\r\n            >\r\n              Ti·∫øp\r\n              <ChevronRight size={16} />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Notifications;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\System\\SystemHealth.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\AdminActionModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\BannedAccounts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\StatusBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\UserDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\Users.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Admin\\Users\\UsersTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Common\\LoadingSpinner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Common\\LocationPickerModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Common\\Navigate.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":28,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[630,645],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { NavLink, Link, useNavigate } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n  Home,\r\n  MessageCircle,\r\n  Moon,\r\n  Search,\r\n  Sun,\r\n  Settings,\r\n  Bell,\r\n  User,\r\n  LogOut,\r\n  Bookmark,\r\n  Sparkles,\r\n  PenSquare,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n} from 'lucide-react';\r\nimport { logout } from '@/redux/actions/authActions';\r\nimport toast from 'react-hot-toast';\r\nimport { useUnreadCount } from '@/hooks/useNotificationQuery';\r\nimport { useUnreadMessagesCount } from '@/hooks/useMessageQuery';\r\n\r\n// Custom Nav Item\r\nconst NavItem = ({\r\n  to,\r\n  icon: Icon,\r\n  label,\r\n  onClick,\r\n  badge,\r\n  isActive: forceActive,\r\n  collapsed,\r\n}) => {\r\n  return (\r\n    <NavLink to={to || '#'} onClick={onClick} className=\"group w-full\">\r\n      {({ isActive }) => {\r\n        const active = forceActive !== undefined ? forceActive : isActive;\r\n        return (\r\n          <div\r\n            className={`flex items-center gap-3 px-3 py-2.5 rounded-full transition-all w-full ${\r\n              active\r\n                ? 'bg-primary text-primary-foreground font-medium'\r\n                : 'text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-black dark:hover:text-white'\r\n            } ${collapsed ? 'justify-center px-2' : ''}`}\r\n            title={collapsed ? label : undefined}\r\n          >\r\n            <div className=\"relative flex-shrink-0\">\r\n              <Icon size={20} strokeWidth={active ? 2.5 : 2} />\r\n              {badge > 0 && (\r\n                <span className=\"absolute -top-1.5 -right-1.5 min-w-[16px] h-[16px] bg-red-500 text-white text-[10px] font-medium rounded-full flex items-center justify-center px-1\">\r\n                  {badge > 99 ? '99+' : badge}\r\n                </span>\r\n              )}\r\n            </div>\r\n            {!collapsed && <span className=\"text-sm truncate\">{label}</span>}\r\n          </div>\r\n        );\r\n      }}\r\n    </NavLink>\r\n  );\r\n};\r\n\r\nexport default function Navigate({ mobile = false, onCollapsedChange }) {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const { user } = useSelector(state => state.auth);\r\n  /* State */\r\n  const [collapsed, setCollapsed] = useState(false);\r\n  const [isDarkMode, setIsDarkMode] = useState(() => {\r\n    const saved = localStorage.getItem('theme');\r\n    if (saved) return saved === 'dark';\r\n    return window.matchMedia('(prefers-color-scheme: dark)').matches;\r\n  });\r\n\r\n  const DEFAULT_USER = {\r\n    name: 'Ng∆∞·ªùi d√πng',\r\n    username: 'user',\r\n    avatar: 'https://via.placeholder.com/40',\r\n  };\r\n\r\n  /* Handlers */\r\n  const handleLogout = async () => {\r\n    await dispatch(logout());\r\n    toast.success('ƒêƒÉng xu·∫•t th√†nh c√¥ng');\r\n    navigate('/auth/login');\r\n  };\r\n\r\n  const toggleTheme = () => {\r\n    const newDark = !isDarkMode;\r\n    setIsDarkMode(newDark);\r\n    localStorage.setItem('theme', newDark ? 'dark' : 'light');\r\n    if (newDark) {\r\n      document.documentElement.classList.add('dark');\r\n    } else {\r\n      document.documentElement.classList.remove('dark');\r\n    }\r\n  };\r\n\r\n  const toggleSidebar = () => {\r\n    const newCollapsed = !collapsed;\r\n    setCollapsed(newCollapsed);\r\n    onCollapsedChange?.(newCollapsed);\r\n  };\r\n\r\n  const { data: messageUnreadCount = 0 } = useUnreadMessagesCount();\r\n\r\n  const { data: notificationUnreadCount = 0 } = useUnreadCount();\r\n\r\n  const navItems = [\r\n    { icon: Home, path: '/', label: 'Home' },\r\n    { icon: Search, path: '/explore', label: 'Explore' },\r\n    {\r\n      icon: Bell,\r\n      path: '/notifications',\r\n      label: 'Notifications',\r\n      badge: notificationUnreadCount,\r\n    },\r\n    {\r\n      icon: MessageCircle,\r\n      path: '/messages',\r\n      label: 'Messages',\r\n      badge: messageUnreadCount,\r\n    },\r\n    { icon: Bookmark, path: '/saved', label: 'Saved' },\r\n    { icon: User, path: '/profile', label: 'Profile' },\r\n  ];\r\n\r\n  // Mobile Bottom Navigation\r\n  if (mobile) {\r\n    return (\r\n      <div className=\"h-[56px] w-full flex justify-around items-center bg-white/95 dark:bg-neutral-900/95 backdrop-blur-xl\">\r\n        {navItems.slice(0, 5).map((item, i) => (\r\n          <NavLink\r\n            key={i}\r\n            to={item.path}\r\n            className={({ isActive }) =>\r\n              `relative flex flex-col items-center justify-center p-2 rounded-full transition-all ${\r\n                isActive\r\n                  ? 'text-black dark:text-white'\r\n                  : 'text-neutral-400 hover:text-black dark:hover:text-white'\r\n              }`\r\n            }\r\n          >\r\n            {({ isActive }) => (\r\n              <>\r\n                {isActive && (\r\n                  <div className=\"absolute -top-1 w-6 h-0.5 rounded-full bg-black dark:bg-white\" />\r\n                )}\r\n                <div className=\"relative\">\r\n                  <item.icon size={22} strokeWidth={isActive ? 2.5 : 2} />\r\n                  {item.badge > 0 && (\r\n                    <span className=\"absolute -top-1.5 -right-1.5 min-w-[16px] h-[16px] bg-red-500 text-white text-[10px] font-medium rounded-full flex items-center justify-center px-1\">\r\n                      {item.badge > 99 ? '99+' : item.badge}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n              </>\r\n            )}\r\n          </NavLink>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Desktop Sidebar\r\n  return (\r\n    <div\r\n      className={`h-full flex flex-col py-6 bg-white dark:bg-neutral-900 transition-all duration-300 ease-in-out ${\r\n        collapsed ? 'px-2 w-[72px]' : 'px-4 w-full'\r\n      }`}\r\n    >\r\n      {/* Logo */}\r\n      <Link\r\n        to=\"/\"\r\n        className={`flex items-center gap-3 mb-8 ${\r\n          collapsed ? 'justify-center px-0' : 'px-1'\r\n        }`}\r\n      >\r\n        <div className=\"w-10 h-10 rounded-full bg-black dark:bg-white flex items-center justify-center flex-shrink-0\">\r\n          <Sparkles size={18} className=\"text-white dark:text-black\" />\r\n        </div>\r\n        {!collapsed && (\r\n          <span className=\"text-xl font-semibold tracking-tight text-black dark:text-white\">\r\n            YiBu\r\n          </span>\r\n        )}\r\n      </Link>\r\n\r\n      {/* Collapse Toggle */}\r\n      <button\r\n        onClick={toggleSidebar}\r\n        className=\"mb-4 p-2 rounded-full bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-all self-center\"\r\n        title={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}\r\n      >\r\n        {collapsed ? (\r\n          <ChevronRight size={16} className=\"text-neutral-500\" />\r\n        ) : (\r\n          <ChevronLeft size={16} className=\"text-neutral-500\" />\r\n        )}\r\n      </button>\r\n\r\n      {/* Navigation */}\r\n      <nav className=\"flex flex-col gap-1 flex-1\">\r\n        {navItems.map((item, i) => (\r\n          <NavItem\r\n            key={i}\r\n            to={item.path}\r\n            icon={item.icon}\r\n            label={item.label}\r\n            badge={item.badge}\r\n            collapsed={collapsed}\r\n          />\r\n        ))}\r\n\r\n        {/* Settings */}\r\n        <NavItem\r\n          to=\"/settings\"\r\n          icon={Settings}\r\n          label=\"Settings\"\r\n          collapsed={collapsed}\r\n        />\r\n\r\n        {/* Theme Toggle */}\r\n        <div\r\n          onClick={toggleTheme}\r\n          className={`flex items-center gap-3 px-3 py-2.5 rounded-full transition-all cursor-pointer text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-black dark:hover:text-white ${\r\n            collapsed ? 'justify-center px-2' : ''\r\n          }`}\r\n          title={\r\n            collapsed ? (isDarkMode ? 'Light mode' : 'Dark mode') : undefined\r\n          }\r\n        >\r\n          <div className=\"flex-shrink-0\">\r\n            {isDarkMode ? <Sun size={20} /> : <Moon size={20} />}\r\n          </div>\r\n          {!collapsed && (\r\n            <span className=\"text-sm\">\r\n              {isDarkMode ? 'Light mode' : 'Dark mode'}\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {/* Create Post Button */}\r\n        {collapsed ? (\r\n          <button\r\n            className=\"mt-6 w-10 h-10 rounded-full bg-primary flex items-center justify-center mx-auto hover:opacity-80 transition-opacity\"\r\n            title=\"Create Post\"\r\n          >\r\n            <PenSquare size={18} className=\"text-primary-foreground\" />\r\n          </button>\r\n        ) : (\r\n          <button className=\"mt-6 flex items-center justify-center gap-2 py-2.5 px-4 w-full bg-primary text-primary-foreground rounded-full font-medium text-sm hover:opacity-90 transition-opacity\">\r\n            <PenSquare size={16} />\r\n            <span>Create Post</span>\r\n          </button>\r\n        )}\r\n      </nav>\r\n\r\n      {/* User Profile Card */}\r\n      <div className=\"mt-auto pt-4\">\r\n        <div\r\n          className={`flex items-center gap-3 p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-all group ${\r\n            collapsed ? 'justify-center' : ''\r\n          }`}\r\n          title={collapsed ? user?.name || DEFAULT_USER.name : undefined}\r\n        >\r\n          <Link to=\"/profile\" className=\"relative flex-shrink-0\">\r\n            <img\r\n              src={user?.avatar || DEFAULT_USER.avatar}\r\n              alt=\"Profile\"\r\n              className=\"w-10 h-10 rounded-full object-cover\"\r\n            />\r\n            <div className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full\" />\r\n          </Link>\r\n          {!collapsed && (\r\n            <>\r\n              <Link to=\"/profile\" className=\"flex-1 min-w-0\">\r\n                <p className=\"text-sm font-medium text-black dark:text-white truncate leading-tight\">\r\n                  {user?.name || DEFAULT_USER.name}\r\n                </p>\r\n                <p className=\"text-xs text-neutral-500 truncate leading-tight mt-0.5\">\r\n                  @{user?.username || DEFAULT_USER.username}\r\n                </p>\r\n              </Link>\r\n              <button\r\n                onClick={handleLogout}\r\n                className=\"p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors\"\r\n                title=\"ƒêƒÉng xu·∫•t\"\r\n              >\r\n                <LogOut\r\n                  size={16}\r\n                  className=\"text-neutral-400 hover:text-red-500\"\r\n                />\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n        {collapsed && (\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"w-full mt-2 p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors flex justify-center\"\r\n            title=\"ƒêƒÉng xu·∫•t\"\r\n          >\r\n            <LogOut size={18} className=\"text-neutral-400 hover:text-red-500\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Common\\UserProfilePreview.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[25,36],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport {\r\n  MapPin,\r\n  Link as LinkIcon,\r\n  Calendar,\r\n  Users,\r\n  UserPlus,\r\n  UserCheck,\r\n} from 'lucide-react';\r\nimport {\r\n  useProfile,\r\n  useFollowUser,\r\n  useUnfollowUser,\r\n  useCheckFollow,\r\n} from '@/hooks/useUserQuery';\r\nimport { useSelector } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst UserProfilePreview = ({ userId, children }) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [position, setPosition] = useState({ top: 0, left: 0 });\r\n  const triggerRef = useRef(null);\r\n  const timeoutRef = useRef(null);\r\n  const authUser = useSelector(state => state.auth.user);\r\n  const isMe = authUser?._id === userId;\r\n\r\n  // Fetch full user details when hovered\r\n  const { data: user, isLoading } = useProfile(isOpen ? userId : null);\r\n\r\n  // Follow status\r\n  const { data: followStatus } = useCheckFollow(userId, !!userId && !isMe);\r\n  const followMutation = useFollowUser();\r\n  const unfollowMutation = useUnfollowUser();\r\n\r\n  const handleMouseEnter = () => {\r\n    if (timeoutRef.current) clearTimeout(timeoutRef.current);\r\n\r\n    if (triggerRef.current) {\r\n      const rect = triggerRef.current.getBoundingClientRect();\r\n      const scrollTop = window.scrollY || document.documentElement.scrollTop;\r\n      const scrollLeft = window.scrollX || document.documentElement.scrollLeft;\r\n\r\n      // Calculate position (try to center it relative to trigger)\r\n      setPosition({\r\n        top: rect.bottom + scrollTop + 8,\r\n        left: rect.left + scrollLeft,\r\n      });\r\n    }\r\n    setIsOpen(true);\r\n  };\r\n\r\n  const handleMouseLeave = () => {\r\n    timeoutRef.current = setTimeout(() => {\r\n      setIsOpen(false);\r\n    }, 400); // Delay closing\r\n  };\r\n\r\n  const handleFollow = async e => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    try {\r\n      if (followStatus?.isFollowing) {\r\n        await unfollowMutation.mutateAsync(userId);\r\n      } else {\r\n        await followMutation.mutateAsync(userId);\r\n      }\r\n    } catch (error) {\r\n      console.error('Follow action failed:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"relative inline-block\"\r\n      onMouseEnter={handleMouseEnter}\r\n      onMouseLeave={handleMouseLeave}\r\n      ref={triggerRef}\r\n    >\r\n      {children}\r\n\r\n      {isOpen &&\r\n        createPortal(\r\n          <div\r\n            className=\"absolute z-[10000]\"\r\n            style={{\r\n              top: position.top,\r\n              left: position.left,\r\n              transform: 'translateX(-5%)',\r\n            }}\r\n            onMouseEnter={() => {\r\n              if (timeoutRef.current) clearTimeout(timeoutRef.current);\r\n            }}\r\n            onMouseLeave={() => setIsOpen(false)}\r\n          >\r\n            <style>\r\n              {`\r\n              @keyframes fadeInSlide {\r\n                from { opacity: 0; transform: translateY(4px); }\r\n                to { opacity: 1; transform: translateY(0); }\r\n              }\r\n              .minimal-preview-card {\r\n                animation: fadeInSlide 0.2s ease-out forwards;\r\n              }\r\n            `}\r\n            </style>\r\n\r\n            <div className=\"minimal-preview-card flex w-[500px] bg-white dark:bg-[#121212] rounded-xl shadow-xl border border-neutral-200 dark:border-neutral-800 overflow-hidden\">\r\n              {/* Sidebar */}\r\n              <div className=\"w-[140px] bg-neutral-50 dark:bg-neutral-900 border-r border-neutral-100 dark:border-neutral-800 flex flex-col items-center pt-6 p-4\">\r\n                <div className=\"relative mb-4\">\r\n                  <img\r\n                    src={user?.avatar || '/images/default-avatar.png'}\r\n                    alt=\"\"\r\n                    className=\"w-20 h-20 rounded-full border border-neutral-200 dark:border-neutral-700 object-cover bg-white\"\r\n                  />\r\n                  {user?.isOnline && (\r\n                    <div className=\"absolute bottom-0.5 right-0.5 w-3.5 h-3.5 bg-green-500 border-2 border-white dark:border-neutral-900 rounded-full\" />\r\n                  )}\r\n                </div>\r\n\r\n                {!isMe && (\r\n                  <button\r\n                    onClick={handleFollow}\r\n                    disabled={\r\n                      followMutation.isPending || unfollowMutation.isPending\r\n                    }\r\n                    className={`w-full py-1.5 rounded-lg text-xs font-semibold transition-colors ${\r\n                      followStatus?.isFollowing\r\n                        ? 'bg-neutral-200 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-300 dark:hover:bg-neutral-700'\r\n                        : 'bg-indigo-600 text-white hover:bg-indigo-700'\r\n                    }`}\r\n                  >\r\n                    {followStatus?.isFollowing ? 'Following' : 'Follow'}\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {/* Main Content */}\r\n              <div className=\"flex-1 p-5 flex flex-col min-w-0\">\r\n                {isLoading ? (\r\n                  <div className=\"space-y-3 animate-pulse\">\r\n                    <div className=\"h-5 bg-neutral-100 dark:bg-neutral-800 rounded w-1/2\" />\r\n                    <div className=\"h-3 bg-neutral-100 dark:bg-neutral-800 rounded w-1/4\" />\r\n                    <div className=\"h-10 bg-neutral-100 dark:bg-neutral-800 rounded w-full\" />\r\n                  </div>\r\n                ) : user ? (\r\n                  <>\r\n                    <div className=\"mb-4\">\r\n                      <Link\r\n                        to={`/profile/${userId}`}\r\n                        onClick={() => setIsOpen(false)}\r\n                        className=\"hover:underline decoration-neutral-400\"\r\n                      >\r\n                        <h4 className=\"text-base font-bold text-neutral-900 dark:text-white truncate\">\r\n                          {user.name}\r\n                          {user.verified && (\r\n                            <span className=\"ml-1 text-blue-500 text-sm\">\r\n                              ‚óè\r\n                            </span>\r\n                          )}\r\n                        </h4>\r\n                      </Link>\r\n                      <p className=\"text-xs text-neutral-500 dark:text-neutral-400 truncate\">\r\n                        @{user.username}\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-6 mb-4\">\r\n                      <div className=\"text-center\">\r\n                        <span className=\"block text-sm font-bold text-neutral-900 dark:text-white\">\r\n                          {user.postsCount || 0}\r\n                        </span>\r\n                        <span className=\"text-[10px] text-neutral-500 uppercase tracking-tight\">\r\n                          Posts\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"text-center\">\r\n                        <span className=\"block text-sm font-bold text-neutral-900 dark:text-white\">\r\n                          {user.followersCount || 0}\r\n                        </span>\r\n                        <span className=\"text-[10px] text-neutral-500 uppercase tracking-tight\">\r\n                          Followers\r\n                        </span>\r\n                      </div>\r\n                      <div className=\"text-center\">\r\n                        <span className=\"block text-sm font-bold text-neutral-900 dark:text-white\">\r\n                          {user.followingCount || 0}\r\n                        </span>\r\n                        <span className=\"text-[10px] text-neutral-500 uppercase tracking-tight\">\r\n                          Following\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"mb-4\">\r\n                      <p className=\"text-xs text-neutral-600 dark:text-neutral-300 leading-normal line-clamp-2\">\r\n                        {user.bio || \"This user hasn't added a bio yet.\"}\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"mt-auto pt-3 border-t border-neutral-100 dark:border-neutral-800 grid grid-cols-2 gap-2\">\r\n                      {user.location && (\r\n                        <div className=\"flex items-center gap-1.5 text-[11px] text-neutral-500\">\r\n                          <MapPin size={12} className=\"shrink-0\" />\r\n                          <span className=\"truncate\">{user.location}</span>\r\n                        </div>\r\n                      )}\r\n                      {user.website && (\r\n                        <div className=\"flex items-center gap-1.5 text-[11px] text-neutral-500\">\r\n                          <LinkIcon size={12} className=\"shrink-0\" />\r\n                          <a\r\n                            href={\r\n                              user.website.startsWith('http')\r\n                                ? user.website\r\n                                : `https://${user.website}`\r\n                            }\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"truncate hover:text-indigo-600\"\r\n                          >\r\n                            {user.website.replace(/^https?:\\/\\//, '')}\r\n                          </a>\r\n                        </div>\r\n                      )}\r\n                      <div className=\"flex items-center gap-1.5 text-[11px] text-neutral-500\">\r\n                        <Calendar size={12} className=\"shrink-0\" />\r\n                        <span>\r\n                          Joined{' '}\r\n                          {new Date(user.createdAt).toLocaleDateString(\r\n                            undefined,\r\n                            { month: 'short', year: 'numeric' }\r\n                          )}\r\n                        </span>\r\n                      </div>\r\n                      {user.gender && (\r\n                        <div className=\"flex items-center gap-1.5 text-[11px] text-neutral-500 capitalize\">\r\n                          <Users size={12} className=\"shrink-0\" />\r\n                          <span>{user.gender}</span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <div className=\"flex-1 flex items-center justify-center text-xs text-neutral-400 italic\">\r\n                    User not found\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>,\r\n          document.body\r\n        )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserProfilePreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\Common\\VideoModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\chat\\ConversationItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\chat\\CreateGroupModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\chat\\GroupInfoModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\chat\\MainMessage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\chat\\MessageDetail.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'conversationsList' logical expression could make the dependencies of useMemo Hook (at line 266) change on every render. Move it inside the useMemo callback. Alternatively, wrap the initialization of 'conversationsList' in its own useMemo() Hook.","line":223,"column":9,"nodeType":"VariableDeclarator","endLine":224,"endColumn":64},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'markAsReadMutation'. Either include it or remove the dependency array.","line":307,"column":6,"nodeType":"ArrayExpression","endLine":307,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [conversationId, joinRoom, leaveRoom, markAsReadMutation]","fix":{"range":[10153,10190],"text":"[conversationId, joinRoom, leaveRoom, markAsReadMutation]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect, useCallback, useMemo } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n  MessageCircle,\r\n  X,\r\n  ArrowLeft,\r\n  MoreHorizontal,\r\n  Send,\r\n  Image as ImageIcon,\r\n  Smile,\r\n  CheckCheck,\r\n  Loader2,\r\n  Trash2,\r\n  Copy,\r\n  Flag,\r\n  Phone,\r\n  Video,\r\n  Info,\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport {\r\n  useConversations,\r\n  useConversationById,\r\n  useMessages,\r\n  useMarkAsRead,\r\n  useSendMessage,\r\n  useDeleteMessage,\r\n  useUpdateGroup,\r\n  useAddGroupMember,\r\n  useRemoveGroupMember,\r\n  useLeaveGroup,\r\n} from '@/hooks/useMessageQuery';\r\nimport { useSocketContext } from '@/contexts/SocketContext';\r\nimport { lazy, Suspense } from 'react';\r\n\r\n// Lazy load modals\r\nconst ReportModal = lazy(() =>\r\n  import('../report/ReportModal').then(module => ({ default: module.default }))\r\n);\r\nconst GroupInfoModal = lazy(() => import('./GroupInfoModal'));\r\n\r\n// --- Sub-components ---\r\n\r\nconst TypingIndicator = ({ username }) => (\r\n  <div className=\"flex items-center gap-3 px-4 py-3 animate-fade-in transition-all\">\r\n    <div className=\"flex gap-1.5 bg-surface-secondary px-3 py-2 rounded-2xl rounded-bl-none\">\r\n      <div className=\"w-1.5 h-1.5 bg-secondary rounded-full animate-bounce [animation-delay:-0.3s]\" />\r\n      <div className=\"w-1.5 h-1.5 bg-secondary rounded-full animate-bounce [animation-delay:-0.15s]\" />\r\n      <div className=\"w-1.5 h-1.5 bg-secondary rounded-full animate-bounce\" />\r\n    </div>\r\n    <span className=\"text-[10px] font-bold text-text-tertiary uppercase tracking-tight\">\r\n      {username} ƒëang so·∫°n...\r\n    </span>\r\n  </div>\r\n);\r\n\r\nconst MessageBubble = ({\r\n  message,\r\n  isOwn,\r\n  showAvatar,\r\n  avatar,\r\n  onDelete,\r\n  onReport,\r\n}) => {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n\r\n  const handleCopy = () => {\r\n    navigator.clipboard.writeText(message.content);\r\n    toast.success('ƒê√£ sao ch√©p tin nh·∫Øn');\r\n    setShowMenu(false);\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`flex w-full mb-1 ${isOwn ? 'justify-end' : 'justify-start'}`}\r\n    >\r\n      <div\r\n        className={`flex max-w-[85%] sm:max-w-[70%] group ${\r\n          isOwn ? 'flex-row-reverse' : 'flex-row'\r\n        } items-end gap-2 relative`}\r\n      >\r\n        {/* Avatar */}\r\n        {!isOwn && (\r\n          <div className=\"w-8 h-8 flex-shrink-0\">\r\n            {showAvatar ? (\r\n              <img\r\n                src={avatar || 'https://via.placeholder.com/150'}\r\n                alt=\"\"\r\n                className=\"w-8 h-8 rounded-full object-cover\"\r\n              />\r\n            ) : (\r\n              <div className=\"w-8\" />\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Bubble */}\r\n        <div className=\"flex flex-col gap-1\">\r\n          <div\r\n            className={`relative px-4 py-2.5 text-sm transition-all duration-200 ${\r\n              isOwn\r\n                ? 'bg-primary text-primary-foreground rounded-2xl rounded-br-none'\r\n                : 'bg-surface-secondary text-content rounded-2xl rounded-bl-none'\r\n            }`}\r\n            onContextMenu={e => {\r\n              e.preventDefault();\r\n              setShowMenu(true);\r\n            }}\r\n          >\r\n            {message.content && (\r\n              <p className=\"whitespace-pre-wrap leading-relaxed break-words font-medium\">\r\n                {message.content}\r\n              </p>\r\n            )}\r\n\r\n            {message.media?.length > 0 && (\r\n              <div className=\"mt-2 space-y-2\">\r\n                {message.media.map((item, i) => (\r\n                  <img\r\n                    key={i}\r\n                    src={item.url}\r\n                    alt=\"\"\r\n                    className=\"rounded-xl max-w-full h-auto object-cover\"\r\n                  />\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            <div\r\n              className={`flex items-center justify-end gap-1 mt-1 ${\r\n                isOwn ? 'opacity-60' : 'text-text-tertiary'\r\n              } text-[10px] font-medium`}\r\n            >\r\n              <span>\r\n                {new Date(message.createdAt).toLocaleTimeString([], {\r\n                  hour: '2-digit',\r\n                  minute: '2-digit',\r\n                })}\r\n              </span>\r\n              {isOwn && (\r\n                <div className=\"ml-0.5\">\r\n                  {message.status === 'read' || message.isRead ? (\r\n                    <CheckCheck size={12} />\r\n                  ) : (\r\n                    <CheckCheck size={12} className=\"opacity-40\" />\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Action Button */}\r\n        <button\r\n          onClick={() => setShowMenu(!showMenu)}\r\n          className={`p-1.5 rounded-full hover:bg-surface-hover opacity-0 group-hover:opacity-100 transition-all ${\r\n            isOwn ? 'mr-1' : 'ml-1'\r\n          }`}\r\n        >\r\n          <MoreHorizontal size={14} className=\"text-text-tertiary\" />\r\n        </button>\r\n\r\n        {/* Floating Menu */}\r\n        {showMenu && (\r\n          <>\r\n            <div\r\n              className=\"fixed inset-0 z-[60]\"\r\n              onClick={() => setShowMenu(false)}\r\n            />\r\n            <div\r\n              className={`absolute ${\r\n                isOwn ? 'right-full mr-2' : 'left-full ml-2'\r\n              } bottom-2 z-[70] bg-surface rounded-xl py-1.5 min-w-[150px] animate-scale-in`}\r\n            >\r\n              <button\r\n                onClick={handleCopy}\r\n                className=\"w-full px-4 py-2 text-left text-xs font-bold flex items-center gap-2.5 hover:bg-surface-hover text-content transition-colors\"\r\n              >\r\n                <Copy size={16} /> Sao ch√©p\r\n              </button>\r\n              {isOwn ? (\r\n                <button\r\n                  onClick={() => {\r\n                    onDelete(message._id || message.id);\r\n                    setShowMenu(false);\r\n                  }}\r\n                  className=\"w-full px-4 py-2 text-left text-xs font-bold flex items-center gap-2.5 hover:bg-error/5 text-error transition-colors\"\r\n                >\r\n                  <Trash2 size={16} /> G·ª° b·ªè\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  onClick={() => {\r\n                    onReport(message._id || message.id);\r\n                    setShowMenu(false);\r\n                  }}\r\n                  className=\"w-full px-4 py-2 text-left text-xs font-bold flex items-center gap-2.5 hover:bg-warning/5 text-warning transition-colors\"\r\n                >\r\n                  <Flag size={16} /> B√°o c√°o\r\n                </button>\r\n              )}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// --- Main Component ---\r\n\r\nconst MessageDetail = () => {\r\n  const { conversationId } = useParams();\r\n  const navigate = useNavigate();\r\n  const { socket, isConnected, joinRoom, leaveRoom, isUserOnline } =\r\n    useSocketContext() || {};\r\n\r\n  const { user: currentUser } = useSelector(state => state.auth);\r\n\r\n  // Queries\r\n  const { data: conversationsData } = useConversations();\r\n  const conversationsList =\r\n    conversationsData?.conversations || conversationsData || [];\r\n\r\n  const { data: conversationData, isLoading: conversationLoading } =\r\n    useConversationById(conversationId);\r\n\r\n  const { data: messagesData, isLoading: messagesLoading } = useMessages({\r\n    conversationId,\r\n    page: 1,\r\n    limit: 50,\r\n  });\r\n  const messagesList = messagesData?.messages || messagesData || [];\r\n\r\n  // Mutations\r\n  const markAsReadMutation = useMarkAsRead();\r\n  const sendMessageMutation = useSendMessage();\r\n  const deleteMessageMutation = useDeleteMessage();\r\n  const updateGroupMutation = useUpdateGroup();\r\n  const addMemberMutation = useAddGroupMember();\r\n  const removeMemberMutation = useRemoveGroupMember();\r\n  const leaveGroupMutation = useLeaveGroup();\r\n\r\n  const [messageText, setMessageText] = useState('');\r\n  const [selectedImages, setSelectedImages] = useState([]);\r\n  const [showGroupInfo, setShowGroupInfo] = useState(false);\r\n  const [reportMessageId, setReportMessageId] = useState(null);\r\n  const [isOtherUserTyping, setIsOtherUserTyping] = useState(false);\r\n  const [isUpdatingGroup, setIsUpdatingGroup] = useState(false);\r\n\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n\r\n  // Derive conversation\r\n  const conversation = useMemo(() => {\r\n    if (conversationData) return conversationData;\r\n    return conversationsList.find(\r\n      c =>\r\n        c._id === conversationId ||\r\n        c.conversationId === conversationId ||\r\n        c.id === conversationId ||\r\n        c.directId === conversationId\r\n    );\r\n  }, [conversationData, conversationsList, conversationId]);\r\n\r\n  const messages = messagesList;\r\n\r\n  const otherUser = useMemo(() => {\r\n    if (!conversation || conversation.isGroup) return null;\r\n\r\n    // Explicitly find the person who is NOT the current user\r\n    const other =\r\n      conversation.otherUser ||\r\n      conversation.participant ||\r\n      conversation.members?.find(\r\n        m => (m._id || m.id)?.toString() !== currentUser?._id?.toString()\r\n      );\r\n\r\n    return other;\r\n  }, [conversation, currentUser]);\r\n\r\n  const chatName = conversation?.isGroup\r\n    ? conversation.name || 'Nh√≥m chat'\r\n    : otherUser?.name ||\r\n      otherUser?.fullName ||\r\n      otherUser?.username ||\r\n      'ƒêang t·∫£i...';\r\n  const chatAvatar = conversation?.isGroup\r\n    ? `https://ui-avatars.com/api/?name=${encodeURIComponent(\r\n        conversation.name || 'G'\r\n      )}&background=random&size=100`\r\n    : otherUser?.avatar || 'https://via.placeholder.com/150';\r\n\r\n  const isOnline = otherUser?._id ? isUserOnline?.(otherUser._id) : false;\r\n\r\n  // Lifecycle - Join room and fetch messages (only when conversationId changes)\r\n  useEffect(() => {\r\n    if (conversationId) {\r\n      if (joinRoom) joinRoom(conversationId);\r\n      markAsReadMutation.mutate(conversationId);\r\n    }\r\n    return () => {\r\n      if (conversationId && leaveRoom) leaveRoom(conversationId);\r\n    };\r\n  }, [conversationId, joinRoom, leaveRoom]);\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages, isOtherUserTyping]);\r\n\r\n  // Socket listeners\r\n  useEffect(() => {\r\n    if (!socket || !isConnected) return;\r\n\r\n    const isCurrentConversation = id => {\r\n      return (\r\n        id === conversationId ||\r\n        (conversation &&\r\n          (id === conversation?._id || id === conversation?.directId))\r\n      );\r\n    };\r\n\r\n    const handleTyping = data => {\r\n      if (\r\n        isCurrentConversation(data.conversationId) &&\r\n        data.senderId !== currentUser?._id\r\n      ) {\r\n        setIsOtherUserTyping(true);\r\n      }\r\n    };\r\n\r\n    const handleStopTyping = data => {\r\n      if (\r\n        isCurrentConversation(data.conversationId) &&\r\n        data.senderId !== currentUser?._id\r\n      ) {\r\n        setIsOtherUserTyping(false);\r\n      }\r\n    };\r\n\r\n    socket.on('user_typing', handleTyping);\r\n    socket.on('user_stop_typing', handleStopTyping);\r\n    return () => {\r\n      socket.off('user_typing', handleTyping);\r\n      socket.off('user_stop_typing', handleStopTyping);\r\n    };\r\n  }, [socket, isConnected, conversationId, currentUser?._id, conversation]);\r\n\r\n  // Handlers\r\n  const emitTyping = useCallback(\r\n    isTyping => {\r\n      if (!socket || !isConnected || !conversationId) return;\r\n      socket.emit(isTyping ? 'user_typing' : 'user_stop_typing', {\r\n        senderId: currentUser?._id,\r\n        conversationId,\r\n      });\r\n    },\r\n    [socket, isConnected, conversationId, currentUser?._id]\r\n  );\r\n\r\n  const handleInputChange = e => {\r\n    setMessageText(e.target.value);\r\n    emitTyping(true);\r\n    if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\r\n    typingTimeoutRef.current = setTimeout(() => emitTyping(false), 2000);\r\n  };\r\n\r\n  const handleSend = async () => {\r\n    if (!messageText.trim() && selectedImages.length === 0) return;\r\n    emitTyping(false);\r\n    try {\r\n      await sendMessageMutation.mutateAsync({\r\n        conversationId,\r\n        content: messageText.trim(),\r\n        type: selectedImages.length > 0 ? 'image' : 'text',\r\n        attachments: selectedImages.length > 0 ? selectedImages : undefined,\r\n      });\r\n      setMessageText('');\r\n      setSelectedImages([]);\r\n    } catch (error) {\r\n      toast.error(error?.response?.data?.message || 'G·ª≠i tin nh·∫Øn th·∫•t b·∫°i');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async mid => {\r\n    try {\r\n      await deleteMessageMutation.mutateAsync({\r\n        conversationId,\r\n        messageId: mid,\r\n      });\r\n      toast.success('ƒê√£ x√≥a tin nh·∫Øn');\r\n    } catch (err) {\r\n      toast.error(err?.response?.data?.message || 'Kh√¥ng th·ªÉ x√≥a tin nh·∫Øn');\r\n    }\r\n  };\r\n\r\n  const handleGroupRename = async name => {\r\n    try {\r\n      setIsUpdatingGroup(true);\r\n      await updateGroupMutation.mutateAsync({\r\n        groupId: conversationId,\r\n        data: { name },\r\n      });\r\n      toast.success('ƒê√£ ƒë·ªïi t√™n nh√≥m');\r\n    } catch (err) {\r\n      toast.error(err?.response?.data?.message || 'C·∫≠p nh·∫≠t th·∫•t b·∫°i');\r\n    } finally {\r\n      setIsUpdatingGroup(false);\r\n    }\r\n  };\r\n\r\n  const handleAddMember = async uid => {\r\n    try {\r\n      await addMemberMutation.mutateAsync({\r\n        groupId: conversationId,\r\n        memberIds: [uid],\r\n      });\r\n      toast.success('ƒê√£ th√™m th√†nh vi√™n');\r\n    } catch (err) {\r\n      toast.error(err?.response?.data?.message || 'Th√™m th√†nh vi√™n th·∫•t b·∫°i');\r\n    }\r\n  };\r\n\r\n  const handleRemoveMember = async uid => {\r\n    try {\r\n      await removeMemberMutation.mutateAsync({\r\n        groupId: conversationId,\r\n        userId: uid,\r\n      });\r\n      toast.success('ƒê√£ m·ªùi th√†nh vi√™n r·ªùi nh√≥m');\r\n    } catch (err) {\r\n      toast.error(err?.response?.data?.message || 'Th·ª±c hi·ªán th·∫•t b·∫°i');\r\n    }\r\n  };\r\n\r\n  const handleLeave = async () => {\r\n    if (window.confirm('B·∫°n c√≥ ch·∫Øc mu·ªën r·ªùi nh√≥m n√†y?')) {\r\n      try {\r\n        await leaveGroupMutation.mutateAsync(conversationId);\r\n        navigate('/messages');\r\n      } catch (err) {\r\n        toast.error(err?.response?.data?.message || 'R·ªùi nh√≥m th·∫•t b·∫°i');\r\n      }\r\n    }\r\n  };\r\n\r\n  if (!conversation && conversationLoading) {\r\n    return (\r\n      <div className=\"flex-1 flex flex-col items-center justify-center space-y-4 bg-white dark:bg-neutral-950\">\r\n        <Loader2 className=\"w-10 h-10 animate-spin text-blue-500\" />\r\n        <p className=\"text-sm font-bold text-neutral-400 uppercase tracking-widest\">\r\n          ƒêang t·∫£i cu·ªôc tr√≤ chuy·ªán...\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const isLoading = messagesLoading || conversationLoading;\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col bg-background animate-fade-in\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between p-4 px-6 bg-surface/80 backdrop-blur-xl z-20 shadow-sm\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <button\r\n            onClick={() => navigate('/messages')}\r\n            className=\"md:hidden p-2 -ml-2 rounded-full hover:bg-surface-hover transition-colors\"\r\n          >\r\n            <ArrowLeft size={20} className=\"text-secondary\" />\r\n          </button>\r\n\r\n          <div\r\n            className=\"relative group cursor-pointer\"\r\n            onClick={() => conversation?.isGroup && setShowGroupInfo(true)}\r\n          >\r\n            <img\r\n              src={chatAvatar}\r\n              alt=\"\"\r\n              className=\"w-11 h-11 rounded-full object-cover group-hover:scale-105 transition-transform ring-2 ring-transparent group-hover:ring-primary/20\"\r\n            />\r\n            {!conversation?.isGroup && isOnline && (\r\n              <div className=\"absolute bottom-0 right-0 w-3.5 h-3.5 bg-success rounded-full\" />\r\n            )}\r\n          </div>\r\n\r\n          <div\r\n            className=\"min-w-0 flex flex-col cursor-pointer\"\r\n            onClick={() => conversation?.isGroup && setShowGroupInfo(true)}\r\n          >\r\n            <h2 className=\"font-bold text-content truncate text-base tracking-tight leading-tight\">\r\n              {chatName}\r\n            </h2>\r\n            <div className=\"flex items-center gap-1.5\">\r\n              {conversation?.isGroup ? (\r\n                <span className=\"text-[10px] font-black text-text-tertiary uppercase tracking-tight\">\r\n                  {conversation.members?.length || 0} th√†nh vi√™n\r\n                </span>\r\n              ) : (\r\n                <span\r\n                  className={`text-[10px] font-black uppercase tracking-tight ${\r\n                    isOnline ? 'text-success' : 'text-text-tertiary'\r\n                  }`}\r\n                >\r\n                  {isOnline ? 'ƒêang ho·∫°t ƒë·ªông' : 'Ngo·∫°i tuy·∫øn'}\r\n                </span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-1\">\r\n          <button className=\"yb-btn-ghost p-2.5 rounded-full transition-all text-secondary hover:text-primary\">\r\n            <Phone size={20} />\r\n          </button>\r\n          <button className=\"yb-btn-ghost p-2.5 rounded-full transition-all text-secondary hover:text-primary\">\r\n            <Video size={20} />\r\n          </button>\r\n          <button\r\n            onClick={() => setShowGroupInfo(true)}\r\n            className=\"yb-btn-ghost p-2.5 rounded-full transition-all text-secondary hover:text-primary\"\r\n          >\r\n            <Info size={22} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Messages Area */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 px-6 space-y-4 scroll-smooth custom-scrollbar relative bg-surface-secondary/30\">\r\n        {isLoading && messages.length === 0 ? (\r\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center space-y-3 bg-surface/50 backdrop-blur-[2px] z-10\">\r\n            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n            <p className=\"text-[10px] font-bold text-text-tertiary uppercase tracking-widest\">\r\n              ƒêang t·∫£i tin nh·∫Øn...\r\n            </p>\r\n          </div>\r\n        ) : null}\r\n\r\n        {messages.length === 0 && !isLoading ? (\r\n          <div className=\"flex flex-col items-center justify-center h-full space-y-6\">\r\n            <div className=\"w-20 h-20 rounded-full bg-surface-hover flex items-center justify-center\">\r\n              <MessageCircle size={32} className=\"text-text-tertiary\" />\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <p className=\"font-bold text-content\">Ch∆∞a c√≥ tin nh·∫Øn n√†o</p>\r\n              <p className=\"text-xs text-text-tertiary font-medium\">\r\n                H√£y g·ª≠i l·ªùi ch√†o ƒë·∫øn {chatName}!\r\n              </p>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"flex flex-col gap-1.5 min-h-full justify-end\">\r\n            {messages.map((msg, idx) => {\r\n              const isOwn =\r\n                msg.isMine ??\r\n                (msg.sender?._id === currentUser?._id ||\r\n                  msg.sender === currentUser?._id);\r\n              const prevMsg = messages[idx - 1];\r\n              const showAvatar =\r\n                !isOwn &&\r\n                (!prevMsg ||\r\n                  (prevMsg.sender?._id || prevMsg.sender) !==\r\n                    (msg.sender?._id || msg.sender));\r\n\r\n              const sender = conversation?.isGroup\r\n                ? conversation.members?.find(\r\n                    m => m._id === (msg.sender?._id || msg.sender)\r\n                  )\r\n                : otherUser;\r\n\r\n              return (\r\n                <div key={msg._id || msg.id} className=\"w-full\">\r\n                  {conversation?.isGroup && !isOwn && showAvatar && (\r\n                    <span className=\"text-[10px] font-bold text-text-tertiary ml-10 mb-1 block uppercase tracking-tight\">\r\n                      {sender?.name || 'Th√†nh vi√™n'}\r\n                    </span>\r\n                  )}\r\n                  <MessageBubble\r\n                    message={msg}\r\n                    isOwn={isOwn}\r\n                    showAvatar={showAvatar}\r\n                    avatar={sender?.avatar}\r\n                    onDelete={handleDelete}\r\n                    onReport={id => setReportMessageId(id)}\r\n                  />\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n        {isOtherUserTyping && (\r\n          <TypingIndicator\r\n            username={conversation?.isGroup ? 'Ai ƒë√≥' : chatName}\r\n          />\r\n        )}\r\n        <div ref={messagesEndRef} className=\"h-2\" />\r\n      </div>\r\n\r\n      {/* Input Area */}\r\n      <div className=\"p-4 px-6 bg-surface\">\r\n        {selectedImages.length > 0 && (\r\n          <div className=\"flex gap-3 overflow-x-auto pb-4 hide-scrollbar\">\r\n            {selectedImages.map((file, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"relative group flex-shrink-0 animate-scale-in\"\r\n              >\r\n                <img\r\n                  src={URL.createObjectURL(file)}\r\n                  alt=\"\"\r\n                  className=\"w-20 h-20 rounded-xl object-cover\"\r\n                />\r\n                <button\r\n                  onClick={() =>\r\n                    setSelectedImages(prev =>\r\n                      prev.filter((_, idx) => idx !== i)\r\n                    )\r\n                  }\r\n                  className=\"absolute -top-2 -right-2 bg-primary text-primary-foreground rounded-full p-1 hover:bg-error transition-colors\"\r\n                >\r\n                  <X size={12} />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            multiple\r\n            accept=\"image/*\"\r\n            className=\"hidden\"\r\n            onChange={e =>\r\n              setSelectedImages(prev => [\r\n                ...prev,\r\n                ...Array.from(e.target.files),\r\n              ])\r\n            }\r\n          />\r\n          <div className=\"flex items-center bg-surface-secondary rounded-2xl flex-1 px-1 focus-within:bg-white transition-all duration-300\">\r\n            <button\r\n              onClick={() => fileInputRef.current?.click()}\r\n              className=\"yb-btn-ghost p-3 text-secondary hover:text-primary rounded-full transition-all\"\r\n            >\r\n              <ImageIcon size={20} />\r\n            </button>\r\n            <button className=\"yb-btn-ghost p-3 text-secondary hover:text-primary rounded-full transition-all\">\r\n              <Smile size={20} />\r\n            </button>\r\n            <input\r\n              type=\"text\"\r\n              value={messageText}\r\n              onChange={handleInputChange}\r\n              onKeyDown={e => e.key === 'Enter' && !e.shiftKey && handleSend()}\r\n              placeholder=\"Nh·∫≠p tin nh·∫Øn...\"\r\n              className=\"flex-1 bg-transparent border-none py-4 px-2 text-sm focus:outline-none text-content placeholder:text-text-tertiary font-medium\"\r\n            />\r\n          </div>\r\n          <button\r\n            onClick={handleSend}\r\n            disabled={\r\n              (!messageText.trim() && selectedImages.length === 0) ||\r\n              sendMessageMutation.isPending\r\n            }\r\n            className={`yb-btn p-4 rounded-full transition-all duration-300 ${\r\n              (messageText.trim() || selectedImages.length > 0) &&\r\n              !sendMessageMutation.isPending\r\n                ? 'yb-btn-primary hover:scale-105 active:scale-95'\r\n                : 'bg-surface-secondary text-text-tertiary cursor-not-allowed'\r\n            }`}\r\n          >\r\n            {sendMessageMutation.isPending ? (\r\n              <Loader2 size={24} className=\"animate-spin\" />\r\n            ) : (\r\n              <Send\r\n                size={24}\r\n                className={\r\n                  messageText.trim() ? 'translate-x-0.5 -translate-y-0.5' : ''\r\n                }\r\n              />\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      <Suspense fallback={null}>\r\n        {showGroupInfo && (\r\n          <GroupInfoModal\r\n            isOpen={showGroupInfo}\r\n            onClose={() => setShowGroupInfo(false)}\r\n            conversation={conversation}\r\n            currentUserId={currentUser?._id}\r\n            onRename={handleRename => handleGroupRename(handleRename)}\r\n            onAddMember={uid => handleAddMember(uid)}\r\n            onRemoveMember={uid => handleRemoveMember(uid)}\r\n            onLeaveGroup={handleLeave}\r\n            isUpdating={isUpdatingGroup}\r\n          />\r\n        )}\r\n        {reportMessageId && (\r\n          <ReportModal\r\n            isOpen={!!reportMessageId}\r\n            onClose={() => setReportMessageId(null)}\r\n            targetId={reportMessageId}\r\n            targetType=\"message\"\r\n          />\r\n        )}\r\n      </Suspense>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MessageDetail;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Comment\\CommentItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Comment\\CommentModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Contents\\Contents.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'setSearchQuery' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSearchQuery"},"fix":{"range":[750,766],"text":""},"desc":"Remove unused variable 'setSearchQuery'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef } from 'react';\r\nimport CreatePost from '@/components/features/feed/Posts/CreatePost';\r\nimport PostLists from '@/components/features/feed/Posts/PostLists';\r\nimport TrendingTopics from '@/components/features/feed/TrendingTopics/TrendingTopics';\r\nimport TopUser from '@/components/features/user/TopUser/TopUser';\r\nimport { Sparkles, TrendingUp, Users, Flame, Zap, Hash } from 'lucide-react';\r\nimport { useTrendingHashtags } from '@/hooks/usePostsQuery';\r\nimport { useSuggestions } from '@/hooks/useUserQuery';\r\nimport { useSearchUsers } from '@/hooks/useSearchQuery';\r\nimport { useDebounce } from '@/hooks/useDebounce';\r\n\r\nconst Contents = () => {\r\n  const [activeTab, setActiveTab] = useState('forYou');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const contentRef = useRef(null);\r\n\r\n  // Debounce search\r\n  const debouncedSearch = useDebounce(searchQuery, 300);\r\n  // React Query hooks\r\n  const { data: trendingHashtags = [] } = useTrendingHashtags(10);\r\n  const { data: suggestionsData, isLoading: suggestionsLoading } =\r\n    useSuggestions(5);\r\n  const suggestions = suggestionsData?.data || suggestionsData || [];\r\n\r\n  const { data: searchResultsData, isLoading: searchLoading } = useSearchUsers({\r\n    query: debouncedSearch,\r\n    page: 1,\r\n    limit: 5,\r\n  });\r\n  const searchResults = searchResultsData?.data || searchResultsData || [];\r\n\r\n  const loading = debouncedSearch.trim() ? searchLoading : suggestionsLoading;\r\n\r\n  const tabs = [\r\n    { id: 'forYou', label: 'For You', icon: Flame },\r\n    { id: 'following', label: 'Following', icon: Users },\r\n    { id: 'latest', label: 'Latest', icon: Zap },\r\n    { id: 'hashtags', label: 'Hashtags', icon: Hash },\r\n  ];\r\n\r\n  // Format trending hashtags for component - handle both array and object with data property\r\n  const hashtagsArray = Array.isArray(trendingHashtags)\r\n    ? trendingHashtags\r\n    : trendingHashtags?.data || [];\r\n  const formattedTrending = hashtagsArray.map(tag => {\r\n    const usage = tag.recentUsage?.last24Hours || tag.totalUsage || 0;\r\n    return {\r\n      name: `#${tag.name || tag.tag}`,\r\n      posts: usage > 1000 ? (usage / 1000).toFixed(1) + 'K' : usage.toString(),\r\n      category: tag.category || 'Trending',\r\n    };\r\n  });\r\n\r\n  // Use suggestions or search results\r\n  const displayUsers = debouncedSearch.trim() ? searchResults : suggestions;\r\n\r\n  return (\r\n    <div className=\"w-full flex gap-10 min-h-screen max-w-[1600px] mx-auto px-4 lg:px-10\">\r\n      {/* Main Feed */}\r\n      <div className=\"flex-1 mx-auto lg:mx-0 h-screen flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"sticky top-0 z-10 pt-4 pb-2 bg-white/80 dark:bg-black/80 backdrop-blur-xl\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div>\r\n              <h1 className=\"text-xl font-semibold text-black dark:text-white\">\r\n                Feed\r\n              </h1>\r\n              <p className=\"text-xs text-neutral-500 mt-0.5\">\r\n                Discover what's happening\r\n              </p>\r\n            </div>\r\n            <button className=\"p-2 rounded-full bg-neutral-100 dark:bg-neutral-900 hover:bg-neutral-200 dark:hover:bg-neutral-800 transition-colors\">\r\n              <Sparkles size={18} className=\"text-neutral-500\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Tab Bar */}\r\n          <div className=\"flex gap-1 p-1 bg-neutral-100 dark:bg-neutral-900 rounded-full\">\r\n            {tabs.map(tab => {\r\n              const Icon = tab.icon;\r\n              return (\r\n                <button\r\n                  key={tab.id}\r\n                  onClick={() => setActiveTab(tab.id)}\r\n                  className={`flex-1 py-2 px-3 rounded-full text-sm font-medium transition-all flex items-center justify-center gap-2 ${\r\n                    activeTab === tab.id\r\n                      ? 'bg-primary text-primary-foreground'\r\n                      : 'text-neutral-500 hover:text-black dark:hover:text-white'\r\n                  }`}\r\n                >\r\n                  <Icon size={14} />\r\n                  <span className=\"hidden sm:inline\">{tab.label}</span>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Scrollable Content */}\r\n        <div\r\n          ref={contentRef}\r\n          className=\"flex-1 overflow-y-auto hide-scrollbar pt-4 space-y-4\"\r\n        >\r\n          <CreatePost />\r\n          <PostLists activeTab={activeTab} />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right Sidebar */}\r\n      <div className=\"hidden lg:flex flex-col flex-1 h-screen sticky top-0 py-4 gap-4\">\r\n        {/* Scrollable Sidebar */}\r\n        <div className=\"flex-1 overflow-y-auto hide-scrollbar space-y-4 flex flex-col\">\r\n          {/* Trending */}\r\n          <div className=\"flex-1 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-4 flex flex-col\">\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <TrendingUp size={16} className=\"text-neutral-500\" />\r\n                <h2 className=\"font-medium text-sm text-black dark:text-white\">\r\n                  Trending Now\r\n                </h2>\r\n              </div>\r\n            </div>\r\n            <TrendingTopics\r\n              trendingTopics={\r\n                formattedTrending.length > 0\r\n                  ? formattedTrending\r\n                  : [\r\n                      {\r\n                        name: '#Trending',\r\n                        posts: '0',\r\n                        category: 'Loading...',\r\n                      },\r\n                    ]\r\n              }\r\n            />\r\n          </div>\r\n\r\n          {/* Suggested Users */}\r\n          <div className=\"flex-1 rounded-2xl border border-neutral-200 dark:border-neutral-800 p-4 flex flex-col\">\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Users size={16} className=\"text-neutral-500\" />\r\n                <h2 className=\"font-medium text-sm text-black dark:text-white\">\r\n                  {debouncedSearch.trim() ? 'Search Results' : 'Suggested'}\r\n                </h2>\r\n              </div>\r\n            </div>\r\n            <TopUser users={displayUsers} loading={loading} />\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"px-2 text-xs text-neutral-400 space-y-2\">\r\n            <div className=\"flex flex-wrap gap-x-3 gap-y-1\">\r\n              {['Terms', 'Privacy', 'Cookies', 'About', 'Help'].map(item => (\r\n                <span\r\n                  key={item}\r\n                  className=\"hover:text-neutral-600 dark:hover:text-neutral-300 cursor-pointer transition-colors\"\r\n                >\r\n                  {item}\r\n                </span>\r\n              ))}\r\n            </div>\r\n            <p className=\"flex items-center gap-1\">\r\n              <Sparkles size={10} />¬© 2025 YiBu\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Contents;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\CreatePost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\InvalidPostFallback.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\ModelPost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\Post.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useSelector' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"useSelector"},"fix":{"range":[103,145],"text":""},"desc":"Remove unused variable 'useSelector'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isGrid' is defined but never used.","line":54,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"isGrid"},"fix":{"range":[1135,1143],"text":""},"desc":"Remove unused variable 'isGrid'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'duration' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":62,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"duration"},"fix":{"range":[1497,1505],"text":""},"desc":"Remove unused variable 'duration'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isInView' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":63,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"isInView"},"fix":{"range":[1545,1553],"text":""},"desc":"Remove unused variable 'isInView'."}]},{"ruleId":"no-undef","severity":2,"message":"'authUser' is not defined.","line":368,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":368,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'response' is defined but never used.","line":407,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":407,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"response"},"fix":{"range":[12819,12827],"text":"()"},"desc":"Remove unused variable 'response'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  useState,\r\n  useCallback,\r\n  lazy,\r\n  Suspense,\r\n  useEffect,\r\n  useRef,\r\n} from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport {\r\n  MoreHorizontal,\r\n  Heart,\r\n  MessageCircle,\r\n  Send,\r\n  Bookmark,\r\n  Eye,\r\n  X,\r\n  Loader2,\r\n  Flag,\r\n  Trash2,\r\n  Edit3,\r\n  EyeOff,\r\n  Link2,\r\n  Share2,\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport {\r\n  useToggleLike,\r\n  useToggleSave,\r\n  useDeletePost,\r\n  useSharePost,\r\n} from '@/hooks/usePostsQuery';\r\nimport UserProfilePreview from '../../../Common/UserProfilePreview';\r\nimport {\r\n  formatCount,\r\n  formatPostTime as formatTime,\r\n} from '@/utils/postUtils';\r\n\r\n// Lazy load modals\r\nconst CommentModal = lazy(() =>\r\n  import('../Comment/CommentModal').then(module => ({\r\n    default: module.default,\r\n  }))\r\n);\r\nconst ReportModal = lazy(() =>\r\n  import('../../report/ReportModal').then(module => ({\r\n    default: module.default,\r\n  }))\r\n);\r\nconst ModelPost = lazy(() => import('./ModelPost'));\r\nconst VideoModal = lazy(() => import('../../../Common/VideoModal'));\r\n\r\n// Inline Video Player with basic controls\r\nconst VideoPlayer = ({ src, onExpand, isGrid }) => {\r\n  const videoRef = useRef(null);\r\n  const containerRef = useRef(null);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [isMuted, setIsMuted] = useState(true);\r\n  const [volume, setVolume] = useState(1);\r\n  const [showVolumeSlider, setShowVolumeSlider] = useState(false);\r\n  const [progress, setProgress] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const [isInView, setIsInView] = useState(false);\r\n\r\n  // Auto play/pause when scrolling in/out of view\r\n  useEffect(() => {\r\n    const video = videoRef.current;\r\n    const container = containerRef.current;\r\n    if (!video || !container) return;\r\n\r\n    const observer = new IntersectionObserver(\r\n      entries => {\r\n        entries.forEach(entry => {\r\n          setIsInView(entry.isIntersecting);\r\n          if (entry.isIntersecting) {\r\n            // Video is in view - auto play\r\n            video.play().catch(() => {});\r\n          } else {\r\n            // Video is out of view - pause\r\n            video.pause();\r\n          }\r\n        });\r\n      },\r\n      {\r\n        threshold: 0.5, // 50% of video must be visible\r\n      }\r\n    );\r\n\r\n    observer.observe(container);\r\n\r\n    return () => {\r\n      observer.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  const togglePlay = e => {\r\n    e.stopPropagation();\r\n    if (videoRef.current) {\r\n      if (isPlaying) {\r\n        videoRef.current.pause();\r\n      } else {\r\n        videoRef.current.play();\r\n      }\r\n      setIsPlaying(!isPlaying);\r\n    }\r\n  };\r\n\r\n  const toggleMute = e => {\r\n    e.stopPropagation();\r\n    if (videoRef.current) {\r\n      videoRef.current.muted = !isMuted;\r\n      setIsMuted(!isMuted);\r\n      if (isMuted && volume === 0) {\r\n        setVolume(1);\r\n        videoRef.current.volume = 1;\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleVolumeChange = e => {\r\n    e.stopPropagation();\r\n    const newVolume = parseFloat(e.target.value);\r\n    if (videoRef.current) {\r\n      videoRef.current.volume = newVolume;\r\n      videoRef.current.muted = newVolume === 0;\r\n      setVolume(newVolume);\r\n      setIsMuted(newVolume === 0);\r\n    }\r\n  };\r\n\r\n  const handleTimeUpdate = () => {\r\n    if (videoRef.current) {\r\n      setProgress(\r\n        (videoRef.current.currentTime / videoRef.current.duration) * 100\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleSeek = e => {\r\n    e.stopPropagation();\r\n    const rect = e.currentTarget.getBoundingClientRect();\r\n    const percent = (e.clientX - rect.left) / rect.width;\r\n    if (videoRef.current) {\r\n      videoRef.current.currentTime = percent * videoRef.current.duration;\r\n    }\r\n  };\r\n\r\n  const formatTime = time => {\r\n    if (isNaN(time)) return '0:00';\r\n    const mins = Math.floor(time / 60);\r\n    const secs = Math.floor(time % 60);\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  return (\r\n    <div ref={containerRef} className=\"relative w-full h-full group\">\r\n      <video\r\n        ref={videoRef}\r\n        src={src}\r\n        playsInline\r\n        muted={isMuted}\r\n        loop\r\n        className=\"w-full h-full object-cover\"\r\n        onTimeUpdate={handleTimeUpdate}\r\n        onLoadedMetadata={() => setDuration(videoRef.current?.duration || 0)}\r\n        onPlay={() => setIsPlaying(true)}\r\n        onPause={() => setIsPlaying(false)}\r\n        onClick={togglePlay}\r\n      />\r\n\r\n      {/* Play/Pause Overlay (shows when paused) */}\r\n      {!isPlaying && (\r\n        <div\r\n          className=\"absolute inset-0 flex items-center justify-center bg-black/30 cursor-pointer\"\r\n          onClick={togglePlay}\r\n        >\r\n          <div className=\"w-14 h-14 rounded-full bg-white/30 backdrop-blur-sm flex items-center justify-center hover:scale-110 transition-transform\">\r\n            <svg\r\n              className=\"w-7 h-7 text-white ml-1\"\r\n              fill=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path d=\"M8 5v14l11-7z\" />\r\n            </svg>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Bottom Controls */}\r\n      <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n        {/* Progress Bar */}\r\n        <div\r\n          className=\"h-1 bg-white/30 rounded-full cursor-pointer mb-2\"\r\n          onClick={handleSeek}\r\n        >\r\n          <div\r\n            className=\"h-full bg-white rounded-full\"\r\n            style={{ width: `${progress}%` }}\r\n          />\r\n        </div>\r\n\r\n        {/* Control Buttons */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-1\">\r\n            {/* Play/Pause */}\r\n            <button\r\n              onClick={togglePlay}\r\n              className=\"p-1.5 rounded-lg hover:bg-white/20 text-white transition-colors\"\r\n            >\r\n              {isPlaying ? (\r\n                <svg\r\n                  className=\"w-4 h-4\"\r\n                  fill=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\r\n                </svg>\r\n              ) : (\r\n                <svg\r\n                  className=\"w-4 h-4\"\r\n                  fill=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path d=\"M8 5v14l11-7z\" />\r\n                </svg>\r\n              )}\r\n            </button>\r\n\r\n            {/* Mute/Unmute with Volume Slider */}\r\n            <div\r\n              className=\"relative flex items-center\"\r\n              onMouseEnter={() => setShowVolumeSlider(true)}\r\n              onMouseLeave={() => setShowVolumeSlider(false)}\r\n            >\r\n              <button\r\n                onClick={toggleMute}\r\n                className=\"p-1.5 rounded-lg hover:bg-white/20 text-white transition-colors\"\r\n              >\r\n                {isMuted || volume === 0 ? (\r\n                  <svg\r\n                    className=\"w-4 h-4\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z\"\r\n                    />\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2\"\r\n                    />\r\n                  </svg>\r\n                ) : (\r\n                  <svg\r\n                    className=\"w-4 h-4\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z\"\r\n                    />\r\n                  </svg>\r\n                )}\r\n              </button>\r\n\r\n              {/* Volume Slider */}\r\n              <div\r\n                className={`flex items-center overflow-hidden transition-all duration-200 ${\r\n                  showVolumeSlider ? 'w-16 ml-1' : 'w-0'\r\n                }`}\r\n              >\r\n                <input\r\n                  type=\"range\"\r\n                  min=\"0\"\r\n                  max=\"1\"\r\n                  step=\"0.1\"\r\n                  value={isMuted ? 0 : volume}\r\n                  onChange={handleVolumeChange}\r\n                  onClick={e => e.stopPropagation()}\r\n                  className=\"w-full h-1 bg-white/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Time */}\r\n            <span className=\"text-white text-xs ml-1\">\r\n              {formatTime(videoRef.current?.currentTime || 0)}\r\n            </span>\r\n          </div>\r\n\r\n          {/* Expand Button */}\r\n          <button\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              onExpand();\r\n            }}\r\n            className=\"p-1.5 rounded-lg hover:bg-white/20 text-white transition-colors\"\r\n            title=\"Expand\"\r\n          >\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\r\n              />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Post = ({ data, onDelete }) => {\r\n\r\n  const [isLiked, setIsLiked] = useState(data?.isLiked || false);\r\n  const [isSaved, setIsSaved] = useState(data?.isSaved || false);\r\n  const [likeCount, setLikeCount] = useState(\r\n    data?.likeCount || data?.likesCount || 0\r\n  );\r\n\r\n  // React Query Mutations\r\n  const { mutate: toggleLike, isPending: likeLoading } = useToggleLike();\r\n  const { mutate: toggleSave, isPending: saveLoading } = useToggleSave();\r\n  const { mutateAsync: deletePostMutation, isPending: deletePending } =\r\n    useDeletePost();\r\n  const { mutateAsync: sharePostMutation, isPending: sharePending } =\r\n    useSharePost();\r\n  // Removed dispatch\r\n\r\n  useEffect(() => {\r\n    setIsLiked(data?.isLiked || false);\r\n    setIsSaved(data?.isSaved || false);\r\n    setLikeCount(data?.likeCount || data?.likesCount || 0);\r\n  }, [\r\n    data?._id,\r\n    data?.isLiked,\r\n    data?.isSaved,\r\n    data?.likeCount,\r\n    data?.likesCount,\r\n  ]);\r\n\r\n  const [showOptions, setShowOptions] = useState(false);\r\n  const [showImage, setShowImage] = useState(null);\r\n  const [showVideo, setShowVideo] = useState(null);\r\n  const [showComments, setShowComments] = useState(false);\r\n  const [showReportModal, setShowReportModal] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  // Removed manual loading states\r\n\r\n  const isOwner = authUser?._id === data?.user?._id;\r\n\r\n  const user = data?.user || {\r\n    name: 'Unknown User',\r\n    username: 'unknown',\r\n    avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=default',\r\n  };\r\n\r\n  const handleLike = useCallback(() => {\r\n    if (likeLoading || !data?._id) return;\r\n\r\n    const prevLiked = isLiked;\r\n    const prevCount = likeCount;\r\n\r\n    // Optimistic update\r\n    setIsLiked(!isLiked);\r\n    setLikeCount(isLiked ? likeCount - 1 : likeCount + 1);\r\n\r\n    toggleLike(data._id, {\r\n      onError: error => {\r\n        // Revert on failure\r\n        setIsLiked(prevLiked);\r\n        setLikeCount(prevCount);\r\n        toast.error(error?.response?.data?.message || 'Thao t√°c th·∫•t b·∫°i');\r\n      },\r\n    });\r\n  }, [data?._id, isLiked, likeCount, likeLoading, toggleLike]);\r\n\r\n  const handleSave = useCallback(() => {\r\n    if (saveLoading || !data?._id) return;\r\n\r\n    const prevSaved = isSaved;\r\n\r\n    // Optimistic update\r\n    setIsSaved(!isSaved);\r\n\r\n    toggleSave(\r\n      { postId: data._id, isSaved: prevSaved },\r\n      {\r\n        onSuccess: response => {\r\n          toast.success(!prevSaved ? 'ƒê√£ l∆∞u b√†i vi·∫øt' : 'ƒê√£ b·ªè l∆∞u b√†i vi·∫øt');\r\n        },\r\n        onError: error => {\r\n          // Revert on failure\r\n          setIsSaved(prevSaved);\r\n          toast.error(error?.response?.data?.message || 'Thao t√°c th·∫•t b·∫°i');\r\n        },\r\n      }\r\n    );\r\n  }, [data?._id, isSaved, saveLoading, toggleSave]);\r\n\r\n  const handleDelete = useCallback(async () => {\r\n    if (deletePending || !data?._id) return;\r\n\r\n    try {\r\n      await deletePostMutation(data._id);\r\n      toast.success('ƒê√£ x√≥a b√†i vi·∫øt');\r\n      setShowDeleteConfirm(false);\r\n      setShowOptions(false);\r\n      // Notify parent to remove from list\r\n      onDelete?.(data._id);\r\n    } catch (error) {\r\n      toast.error(error?.response?.data?.message || 'X√≥a b√†i vi·∫øt th·∫•t b·∫°i');\r\n    }\r\n  }, [deletePending, data?._id, onDelete, deletePostMutation]);\r\n\r\n  const handleShare = useCallback(async () => {\r\n    if (sharePending || !data?._id) return;\r\n\r\n    try {\r\n      await sharePostMutation({ postId: data._id });\r\n      toast.success('ƒê√£ chia s·∫ª b√†i vi·∫øt');\r\n      setShowOptions(false);\r\n    } catch (error) {\r\n      toast.error(error?.response?.data?.message || 'Chia s·∫ª th·∫•t b·∫°i');\r\n    }\r\n  }, [sharePending, data?._id, sharePostMutation]);\r\n\r\n  const handleCopyLink = useCallback(() => {\r\n    const url = `${window.location.origin}/post/${data?._id}`;\r\n    navigator.clipboard.writeText(url);\r\n    toast.success('ƒê√£ sao ch√©p link');\r\n    setShowOptions(false);\r\n  }, [data?._id]);\r\n\r\n  if (!data)\r\n    return (\r\n      <div className=\"p-4 text-center text-neutral-500\">\r\n        No post data available\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <article className=\"rounded-2xl p-4 bg-white dark:bg-neutral-900 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors\">\r\n      {/* Header */}\r\n      <div className=\"flex items-start justify-between mb-3\">\r\n        <UserProfilePreview userId={user._id || user.id}>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"relative group cursor-pointer\">\r\n              <img\r\n                className=\"w-11 h-11 rounded-full object-cover\"\r\n                src={user.avatar}\r\n                alt={user.name}\r\n              />\r\n              <div className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-neutral-900 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n            </div>\r\n            <div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"font-semibold text-content dark:text-white hover:underline cursor-pointer\">\r\n                  {user.name}\r\n                </span>\r\n                {user.verified && (\r\n                  <div className=\"w-4 h-4 rounded-full bg-primary flex items-center justify-center\">\r\n                    <svg\r\n                      width=\"10\"\r\n                      height=\"10\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      fill=\"currentColor\"\r\n                      className=\"text-primary-foreground\"\r\n                    >\r\n                      <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\" />\r\n                    </svg>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"flex items-center gap-1.5 text-sm text-secondary\">\r\n                <span>@{user.username}</span>\r\n                <span>‚Ä¢</span>\r\n                <span>{formatTime(data.createdAt)}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </UserProfilePreview>\r\n\r\n        <button\r\n          onClick={() => setShowOptions(!showOptions)}\r\n          className=\"p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-400 hover:text-content dark:hover:text-white transition-all\"\r\n        >\r\n          <MoreHorizontal size={18} />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      {data.caption && (\r\n        <p className=\"text-content dark:text-white leading-relaxed mb-3 whitespace-pre-wrap break-words\">\r\n          {data.caption}\r\n        </p>\r\n      )}\r\n\r\n      {/* Media */}\r\n      {data.media && data.media.length > 0 && (\r\n        <div\r\n          className={`rounded-xl overflow-hidden mb-3 ${\r\n            data.media.length === 1 ? '' : 'grid gap-1'\r\n          } ${data.media.length === 2 ? 'grid-cols-2' : ''} ${\r\n            data.media.length >= 3 ? 'grid-cols-2' : ''\r\n          }`}\r\n        >\r\n          {data.media.slice(0, 4).map((item, index) => (\r\n            <div\r\n              key={index}\r\n              className={`relative overflow-hidden ${\r\n                data.media.length === 3 && index === 0 ? 'row-span-2' : ''\r\n              } ${data.media.length === 1 ? 'max-h-[450px]' : 'aspect-square'}`}\r\n            >\r\n              {item.type === 'video' ? (\r\n                <VideoPlayer\r\n                  src={item.url}\r\n                  onExpand={() => setShowVideo(item.url)}\r\n                  isGrid={data.media.length > 1}\r\n                />\r\n              ) : (\r\n                <img\r\n                  className={`w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform duration-300 ${\r\n                    data.media.length === 1 ? 'max-h-[450px]' : ''\r\n                  }`}\r\n                  src={item.url}\r\n                  alt={`Post media ${index + 1}`}\r\n                  onClick={() => setShowImage(item.url)}\r\n                />\r\n              )}\r\n              {data.media.length > 4 && index === 3 && (\r\n                <div className=\"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center\">\r\n                  <span className=\"text-white text-2xl font-bold\">\r\n                    +{data.media.length - 4}\r\n                  </span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Stats Row */}\r\n      <div className=\"flex items-center gap-4 py-2 mb-2 text-sm text-neutral-400\">\r\n        <span className=\"flex items-center gap-1\">\r\n          <Eye size={14} />\r\n          {formatCount(data.viewCount || 0)} views\r\n        </span>\r\n      </div>\r\n\r\n      {/* Divider */}\r\n      <div className=\"h-px bg-neutral-100 dark:bg-neutral-800/50 mb-3\" />\r\n\r\n      {/* Action Buttons */}\r\n      <div className=\"flex items-center justify-between\">\r\n        {/* Left Actions */}\r\n        <div className=\"flex items-center gap-1\">\r\n          {/* Like */}\r\n          <button\r\n            onClick={handleLike}\r\n            disabled={likeLoading}\r\n            className={`flex items-center gap-2 px-3 py-2 rounded-full transition-all ${\r\n              likeLoading ? 'opacity-50 cursor-not-allowed' : ''\r\n            } ${\r\n              isLiked\r\n                ? 'text-red-500 bg-red-50 dark:bg-red-500/10'\r\n                : 'text-neutral-500 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10'\r\n            }`}\r\n          >\r\n            {likeLoading ? (\r\n              <Loader2 size={18} className=\"animate-spin\" />\r\n            ) : (\r\n              <Heart size={18} className={isLiked ? 'fill-current' : ''} />\r\n            )}\r\n            {likeCount > 0 && (\r\n              <span className=\"text-sm font-medium\">\r\n                {formatCount(likeCount)}\r\n              </span>\r\n            )}\r\n          </button>\r\n\r\n          {/* Comment */}\r\n          <button\r\n            onClick={() => setShowComments(true)}\r\n            className=\"flex items-center gap-2 px-3 py-2 rounded-full text-neutral-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-500/10 transition-all\"\r\n          >\r\n            <MessageCircle size={18} />\r\n            {(data.commentCount || data.commentsCount || 0) > 0 && (\r\n              <span className=\"text-sm font-medium\">\r\n                {formatCount(data.commentCount || data.commentsCount || 0)}\r\n              </span>\r\n            )}\r\n          </button>\r\n\r\n          {/* Share */}\r\n          <button\r\n            onClick={handleShare}\r\n            disabled={sharePending}\r\n            className={`flex items-center gap-2 px-3 py-2 rounded-full text-neutral-500 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-500/10 transition-all ${\r\n              sharePending ? 'opacity-50 cursor-not-allowed' : ''\r\n            }`}\r\n          >\r\n            {sharePending ? (\r\n              <Loader2 size={18} className=\"animate-spin\" />\r\n            ) : (\r\n              <Send size={18} />\r\n            )}\r\n          </button>\r\n        </div>\r\n\r\n        {/* Right Actions */}\r\n        <button\r\n          onClick={handleSave}\r\n          disabled={saveLoading}\r\n          className={`p-2 rounded-full transition-all ${\r\n            saveLoading ? 'opacity-50 cursor-not-allowed' : ''\r\n          } ${\r\n            isSaved\r\n              ? 'text-yellow-500 bg-yellow-50 dark:bg-yellow-500/10'\r\n              : 'text-neutral-500 hover:text-yellow-500 hover:bg-yellow-50 dark:hover:bg-yellow-500/10'\r\n          }`}\r\n        >\r\n          {saveLoading ? (\r\n            <Loader2 size={18} className=\"animate-spin\" />\r\n          ) : (\r\n            <Bookmark size={18} className={isSaved ? 'fill-current' : ''} />\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Image Modal */}\r\n      {showImage && (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/90\"\r\n          onClick={() => setShowImage(null)}\r\n        >\r\n          <img\r\n            src={showImage}\r\n            alt=\"Full view\"\r\n            className=\"max-w-[90vw] max-h-[90vh] rounded-xl\"\r\n          />\r\n          <button\r\n            className=\"absolute top-4 right-4 bg-white/10 backdrop-blur-sm text-white p-2.5 rounded-xl hover:bg-white/20 transition-colors\"\r\n            onClick={() => setShowImage(null)}\r\n          >\r\n            <X size={20} />\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Options Modal */}\r\n      {showOptions && (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\r\n          onClick={() => setShowOptions(false)}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-sm bg-white dark:bg-neutral-900 rounded-2xl overflow-hidden\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            {/* Owner actions */}\r\n            {isOwner && (\r\n              <>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowEditModal(true);\r\n                    setShowOptions(false);\r\n                  }}\r\n                  className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-content dark:text-white\"\r\n                >\r\n                  <Edit3 size={18} />\r\n                  Edit post\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    setShowDeleteConfirm(true);\r\n                    setShowOptions(false);\r\n                  }}\r\n                  className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-red-500\"\r\n                >\r\n                  <Trash2 size={18} />\r\n                  Delete post\r\n                </button>\r\n              </>\r\n            )}\r\n\r\n            {/* Report - only for non-owners */}\r\n            {!isOwner && (\r\n              <button\r\n                onClick={() => {\r\n                  setShowReportModal(true);\r\n                  setShowOptions(false);\r\n                }}\r\n                className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-red-500\"\r\n              >\r\n                <Flag size={18} />\r\n                Report post\r\n              </button>\r\n            )}\r\n\r\n            <button\r\n              onClick={handleShare}\r\n              disabled={sharePending}\r\n              className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-content dark:text-white\"\r\n            >\r\n              <Share2 size={18} />\r\n              {sharePending ? 'Sharing...' : 'Share post'}\r\n            </button>\r\n\r\n            <button\r\n              onClick={handleCopyLink}\r\n              className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-content dark:text-white\"\r\n            >\r\n              <Link2 size={18} />\r\n              Copy link\r\n            </button>\r\n\r\n            {!isOwner && (\r\n              <button className=\"w-full px-4 py-3 flex items-center gap-3 hover:bg-neutral-100 dark:hover:bg-neutral-800 text-content dark:text-white\">\r\n                <EyeOff size={18} />\r\n                Hide post\r\n              </button>\r\n            )}\r\n\r\n            <button\r\n              onClick={() => setShowOptions(false)}\r\n              className=\"w-full px-4 py-3 text-left hover:bg-neutral-100 dark:hover:bg-neutral-800 text-neutral-500\"\r\n            >\r\n              Cancel\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {showDeleteConfirm && (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\r\n          onClick={() => setShowDeleteConfirm(false)}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-sm bg-white dark:bg-neutral-900 rounded-2xl overflow-hidden p-6\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            <h3 className=\"text-lg font-semibold text-content dark:text-white mb-2\">\r\n              Delete Post?\r\n            </h3>\r\n            <p className=\"text-sm text-neutral-500 mb-6\">\r\n              This action cannot be undone. The post will be permanently\r\n              removed.\r\n            </p>\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={() => setShowDeleteConfirm(false)}\r\n                className=\"flex-1 px-4 py-2.5 rounded-full bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white text-sm font-medium hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleDelete}\r\n                disabled={deletePending}\r\n                className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-full bg-red-500 text-white text-sm font-medium hover:bg-red-600 transition-colors\"\r\n              >\r\n                {deletePending ? (\r\n                  <Loader2 size={16} className=\"animate-spin\" />\r\n                ) : (\r\n                  <>\r\n                    <Trash2 size={16} />\r\n                    Delete\r\n                  </>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Report Modal */}\r\n      {showReportModal && (\r\n        <Suspense fallback={null}>\r\n          <ReportModal\r\n            isOpen={showReportModal}\r\n            onClose={() => setShowReportModal(false)}\r\n            targetId={data?._id}\r\n            targetType=\"post\"\r\n          />\r\n        </Suspense>\r\n      )}\r\n\r\n      {/* Edit Post Modal */}\r\n      {showEditModal && (\r\n        <Suspense fallback={null}>\r\n          <ModelPost\r\n            closeModal={() => setShowEditModal(false)}\r\n            editPost={data}\r\n          />\r\n        </Suspense>\r\n      )}\r\n\r\n      {/* Comments Modal Placeholder */}\r\n      {showComments && (\r\n        <Suspense fallback={null}>\r\n          <CommentModal\r\n            onClose={() => setShowComments(false)}\r\n            postId={data?._id}\r\n          />\r\n        </Suspense>\r\n      )}\r\n\r\n      {/* Video Modal */}\r\n      {showVideo && (\r\n        <Suspense fallback={null}>\r\n          <VideoModal videoUrl={showVideo} onClose={() => setShowVideo(null)} />\r\n        </Suspense>\r\n      )}\r\n    </article>\r\n  );\r\n};\r\n\r\nexport default Post;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\PostLists.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\PostOption.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\ShowImagePost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\Posts\\ShowVideoPost.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\TrendingTopics\\TrendingCircles.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\feed\\TrendingTopics\\TrendingTopics.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useState' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[82,115],"text":""},"desc":"Remove unused variable 'useState'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { TrendingUp, Hash, ChevronRight, LayoutGrid, List } from 'lucide-react';\r\nimport { useState } from 'react';\r\nimport TrendingCircles from './TrendingCircles';\r\n\r\nconst TrendingTopics = ({ trendingTopics = [] }) => {\r\n  if (trendingTopics.length === 0) return null;\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-4\">\r\n      <TrendingCircles trendingTopics={trendingTopics} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TrendingTopics;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\notifications\\NotificationBell.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\notifications\\NotificationPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\report\\ReportModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\search\\SearchUser.jsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'useCallback' is not defined.","line":54,"column":24,"nodeType":"Identifier","messageId":"undef","endLine":54,"endColumn":35}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport { Search, X, UserPlus, Check, Loader2 } from 'lucide-react';\r\nimport { useSearchUsers } from '@/hooks/useSearchQuery';\r\nimport { useFollowUser, useUnfollowUser } from '@/hooks/useUserQuery';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SearchUser = ({ isOpen, onClose }) => {\r\n  const { user: currentUser } = useSelector(state => state.auth);\r\n\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const searchInputRef = useRef(null);\r\n  const modalRef = useRef(null);\r\n  const [debouncedSearch, setDebouncedSearch] = useState('');\r\n\r\n  const followMutation = useFollowUser();\r\n  const unfollowMutation = useUnfollowUser();\r\n\r\n  useEffect(() => {\r\n    if (isOpen && searchInputRef.current) {\r\n      searchInputRef.current.focus();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = event => {\r\n      if (modalRef.current && !modalRef.current.contains(event.target)) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [isOpen, onClose]);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedSearch(searchQuery);\r\n    }, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  const { data: searchResults, isLoading: loading } = useSearchUsers({\r\n    query: debouncedSearch,\r\n    page: 1,\r\n    limit: 10,\r\n  });\r\n\r\n  const handleFollow = useCallback(\r\n    async (e, userId, isCurrentlyFollowing) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      try {\r\n        if (isCurrentlyFollowing) {\r\n          await unfollowMutation.mutateAsync(userId);\r\n          toast.success('ƒê√£ b·ªè theo d√µi');\r\n        } else {\r\n          await followMutation.mutateAsync(userId);\r\n          toast.success('ƒê√£ theo d√µi');\r\n        }\r\n      } catch (error) {\r\n        toast.error(error?.response?.data?.message || 'Thao t√°c th·∫•t b·∫°i');\r\n      }\r\n    },\r\n    [followMutation, unfollowMutation]\r\n  );\r\n\r\n  const handleClearSearch = () => {\r\n    setSearchQuery('');\r\n  };\r\n\r\n  const users =\r\n    searchResults?.users || searchResults?.data || searchResults || [];\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[60] flex items-start justify-center bg-black/50 backdrop-blur-sm pt-[10vh]\">\r\n      <div\r\n        ref={modalRef}\r\n        className=\"w-full max-w-[600px] bg-white dark:bg-neutral-900 rounded-2xl shadow-2xl flex flex-col max-h-[70vh] overflow-hidden mx-4\"\r\n      >\r\n        {/* Search Header */}\r\n        <div className=\"p-4 border-b border-neutral-200 dark:border-neutral-800\">\r\n          <div className=\"relative\">\r\n            <Search\r\n              size={18}\r\n              className=\"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400\"\r\n            />\r\n            <input\r\n              ref={searchInputRef}\r\n              type=\"text\"\r\n              value={searchQuery}\r\n              onChange={e => setSearchQuery(e.target.value)}\r\n              placeholder=\"Search users...\"\r\n              className=\"w-full pl-10 pr-10 py-3 rounded-full bg-neutral-100 dark:bg-neutral-800 text-black dark:text-white placeholder:text-neutral-400 text-sm focus:outline-none focus:ring-2 focus:ring-black dark:focus:ring-white\"\r\n            />\r\n            {searchQuery && (\r\n              <button\r\n                onClick={handleClearSearch}\r\n                className=\"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-700\"\r\n              >\r\n                <X size={16} className=\"text-neutral-400\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search Results */}\r\n        <div className=\"flex-1 overflow-y-auto\">\r\n          {loading ? (\r\n            <div className=\"p-8 text-center\">\r\n              <Loader2 className=\"w-6 h-6 animate-spin mx-auto text-neutral-400\" />\r\n            </div>\r\n          ) : users.length === 0 ? (\r\n            <div className=\"p-8 text-center\">\r\n              {searchQuery ? (\r\n                <>\r\n                  <Search size={32} className=\"mx-auto text-neutral-300 mb-2\" />\r\n                  <p className=\"text-neutral-500 text-sm\">No users found</p>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <Search size={32} className=\"mx-auto text-neutral-300 mb-2\" />\r\n                  <p className=\"text-neutral-500 text-sm\">\r\n                    Search for users by name or username\r\n                  </p>\r\n                </>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            users.map(user => {\r\n              const isFollowed = user.isFollowing;\r\n              const isMutationLoading =\r\n                (followMutation.isPending &&\r\n                  followMutation.variables === user._id) ||\r\n                (unfollowMutation.isPending &&\r\n                  unfollowMutation.variables === user._id);\r\n              const isSelf = currentUser?._id === user._id;\r\n\r\n              return (\r\n                <Link\r\n                  key={user._id}\r\n                  to={`/profile/${user._id}`}\r\n                  onClick={onClose}\r\n                  className=\"flex items-center gap-3 p-4 hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors\"\r\n                >\r\n                  {/* Avatar */}\r\n                  <img\r\n                    src={\r\n                      user.avatar ||\r\n                      `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.username}`\r\n                    }\r\n                    alt={user.name || user.username}\r\n                    className=\"w-12 h-12 rounded-full object-cover border-2 border-neutral-200 dark:border-neutral-700\"\r\n                  />\r\n\r\n                  {/* Info */}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <span className=\"font-medium text-black dark:text-white truncate\">\r\n                        {user.name || user.fullName || user.username}\r\n                      </span>\r\n                    </div>\r\n                    <p className=\"text-sm text-neutral-500 truncate\">\r\n                      @{user.username}\r\n                    </p>\r\n                    {user.bio && (\r\n                      <p className=\"text-xs text-neutral-400 truncate mt-0.5\">\r\n                        {user.bio}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* Follow Button - Don't show for self */}\r\n                  {!isSelf && (\r\n                    <button\r\n                      onClick={e => handleFollow(e, user._id, isFollowed)}\r\n                      disabled={isMutationLoading}\r\n                      className={`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium transition-colors ${\r\n                        isMutationLoading ? 'opacity-50 cursor-not-allowed' : ''\r\n                      } ${\r\n                        isFollowed\r\n                          ? 'bg-neutral-100 dark:bg-neutral-800 text-black dark:text-white border border-neutral-200 dark:border-neutral-700'\r\n                          : 'bg-primary text-primary-foreground'\r\n                      }`}\r\n                    >\r\n                      {isMutationLoading ? (\r\n                        <Loader2 size={14} className=\"animate-spin\" />\r\n                      ) : isFollowed ? (\r\n                        <>\r\n                          <Check size={14} />\r\n                          Following\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <UserPlus size={14} />\r\n                          Follow\r\n                        </>\r\n                      )}\r\n                    </button>\r\n                  )}\r\n                </Link>\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n\r\n        {/* Close Button */}\r\n        <div className=\"p-4 border-t border-neutral-200 dark:border-neutral-800\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"w-full py-2.5 rounded-full bg-neutral-100 dark:bg-neutral-800 text-black dark:text-white text-sm font-medium hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors\"\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchUser;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\AccountSettings.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":91,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[2583,2594],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {\r\n  User,\r\n  Mail,\r\n  Lock,\r\n  Shield,\r\n  Trash2,\r\n  LogOut,\r\n  Monitor,\r\n} from 'lucide-react';\r\nimport { logout, logoutAll, updatePassword } from '@/redux/actions/authActions';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst AccountSettings = () => {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const { user: authUser } = useSelector(state => state.auth);\r\n\r\n  // Use authUser or empty object\r\n  const profile = authUser || {};\r\n\r\n  const [account, setAccount] = useState({\r\n    email: 'johndoe@example.com',\r\n    username: 'johndoe',\r\n    phone: '',\r\n  });\r\n\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [showPasswordModal, setShowPasswordModal] = useState(false);\r\n  const [passwordData, setPasswordData] = useState({\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: '',\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleLogout = async () => {\r\n    const result = await dispatch(logout());\r\n    if (logout.fulfilled.match(result)) {\r\n      toast.success('ƒêƒÉng xu·∫•t th√†nh c√¥ng');\r\n      navigate('/auth/login');\r\n    }\r\n  };\r\n\r\n  const handleLogoutAll = async () => {\r\n    const result = await dispatch(logoutAll());\r\n    if (logoutAll.fulfilled.match(result)) {\r\n      toast.success('ƒê√£ ƒëƒÉng xu·∫•t kh·ªèi t·∫•t c·∫£ thi·∫øt b·ªã');\r\n      navigate('/auth/login');\r\n    }\r\n  };\r\n\r\n  const handleUpdatePassword = async () => {\r\n    if (!passwordData.currentPassword || !passwordData.newPassword) {\r\n      toast.error('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin');\r\n      return;\r\n    }\r\n    if (passwordData.newPassword.length < 6) {\r\n      toast.error('M·∫≠t kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±');\r\n      return;\r\n    }\r\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\r\n      toast.error('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    const result = await dispatch(\r\n      updatePassword({\r\n        currentPassword: passwordData.currentPassword,\r\n        newPassword: passwordData.newPassword,\r\n      })\r\n    );\r\n    setLoading(false);\r\n\r\n    if (updatePassword.fulfilled.match(result)) {\r\n      toast.success('ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng. Vui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i');\r\n      setShowPasswordModal(false);\r\n      setPasswordData({\r\n        currentPassword: '',\r\n        newPassword: '',\r\n        confirmPassword: '',\r\n      });\r\n      navigate('/auth/login');\r\n    }\r\n  };\r\n\r\n  const InputField = ({\r\n    icon: Icon,\r\n    label,\r\n    type = 'text',\r\n    value,\r\n    onChange,\r\n    placeholder,\r\n  }) => (\r\n    <div className=\"space-y-2\">\r\n      <label className=\"text-sm font-medium text-content dark:text-white\">\r\n        {label}\r\n      </label>\r\n      <div className=\"relative\">\r\n        <Icon\r\n          size={18}\r\n          className=\"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400\"\r\n        />\r\n        <input\r\n          type={type}\r\n          value={value}\r\n          onChange={onChange}\r\n          placeholder={placeholder}\r\n          className=\"w-full pl-10 pr-4 py-2.5 rounded-xl bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white placeholder:text-neutral-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      <div>\r\n        <h1 className=\"text-2xl font-bold text-content dark:text-white mb-2\">\r\n          Account\r\n        </h1>\r\n        <p className=\"text-neutral-500 text-sm\">\r\n          Manage your account information and security\r\n        </p>\r\n      </div>\r\n\r\n      {/* Account Info */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-neutral-50/50 dark:bg-neutral-800/20\">\r\n        <div className=\"px-4 py-3 bg-neutral-100/50 dark:bg-neutral-700/30\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <User size={16} className=\"text-neutral-500\" />\r\n            <h3 className=\"text-sm font-medium text-content dark:text-white\">\r\n              Account Information\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4 space-y-4\">\r\n          <InputField\r\n            icon={User}\r\n            label=\"Username\"\r\n            value={profile.username || ''}\r\n            onChange={e => setAccount({ ...account, username: e.target.value })}\r\n            placeholder=\"Enter username\"\r\n          />\r\n          <InputField\r\n            icon={Mail}\r\n            label=\"Email\"\r\n            type=\"email\"\r\n            value={profile.email || ''}\r\n            onChange={e => setAccount({ ...account, email: e.target.value })}\r\n            placeholder=\"Enter email\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Security */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-neutral-50/50 dark:bg-neutral-800/20\">\r\n        <div className=\"px-4 py-3 bg-neutral-100/50 dark:bg-neutral-700/30\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Shield size={16} className=\"text-neutral-500\" />\r\n            <h3 className=\"text-sm font-medium text-content dark:text-white\">\r\n              Security\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4 space-y-4\">\r\n          <button\r\n            onClick={() => setShowPasswordModal(true)}\r\n            className=\"w-full flex items-center justify-between p-3 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors\"\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <Lock size={18} className=\"text-neutral-500\" />\r\n              <div className=\"text-left\">\r\n                <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                  Change Password\r\n                </p>\r\n                <p className=\"text-xs text-neutral-500\">\r\n                  Update your password regularly for security\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <span className=\"text-xs text-neutral-400\">‚Üí</span>\r\n          </button>\r\n\r\n          <button className=\"w-full flex items-center justify-between p-3 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Shield size={18} className=\"text-neutral-500\" />\r\n              <div className=\"text-left\">\r\n                <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                  Two-Factor Authentication\r\n                </p>\r\n                <p className=\"text-xs text-neutral-500\">\r\n                  Add an extra layer of security\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <span className=\"text-xs px-2 py-0.5 bg-neutral-100 dark:bg-neutral-800 rounded-full text-neutral-500\">\r\n              Off\r\n            </span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Session Management */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-neutral-50/50 dark:bg-neutral-800/20\">\r\n        <div className=\"px-4 py-3 bg-neutral-100/50 dark:bg-neutral-700/30\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Monitor size={16} className=\"text-neutral-500\" />\r\n            <h3 className=\"text-sm font-medium text-content dark:text-white\">\r\n              Sessions\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4 space-y-4\">\r\n          <button\r\n            onClick={handleLogout}\r\n            className=\"w-full flex items-center justify-between p-3 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors\"\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <LogOut size={18} className=\"text-neutral-500\" />\r\n              <div className=\"text-left\">\r\n                <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                  Logout\r\n                </p>\r\n                <p className=\"text-xs text-neutral-500\">\r\n                  Sign out from this device\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <span className=\"text-xs text-neutral-400\">‚Üí</span>\r\n          </button>\r\n\r\n          <button\r\n            onClick={handleLogoutAll}\r\n            className=\"w-full flex items-center justify-between p-3 rounded-xl hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-colors\"\r\n          >\r\n            <div className=\"flex items-center gap-3\">\r\n              <Monitor size={18} className=\"text-red-500\" />\r\n              <div className=\"text-left\">\r\n                <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                  Logout from all devices\r\n                </p>\r\n                <p className=\"text-xs text-neutral-500\">\r\n                  Sign out from all your active sessions\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <span className=\"text-xs text-neutral-400\">‚Üí</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Danger Zone */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-red-50/30 dark:bg-red-900/10\">\r\n        <div className=\"px-4 py-3 bg-red-50/50 dark:bg-red-900/20\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Trash2 size={16} className=\"text-red-500\" />\r\n            <h3 className=\"text-sm font-medium text-red-600 dark:text-red-400\">\r\n              Danger Zone\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4\">\r\n          <button\r\n            onClick={() => setShowDeleteModal(true)}\r\n            className=\"w-full py-2.5 rounded-xl bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm font-medium hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors\"\r\n          >\r\n            Delete Account\r\n          </button>\r\n          <p className=\"text-xs text-neutral-500 mt-2 text-center\">\r\n            This action cannot be undone. All your data will be permanently\r\n            deleted.\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Delete Modal */}\r\n      {showDeleteModal && (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\r\n          onClick={() => setShowDeleteModal(false)}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-sm mx-4 bg-white dark:bg-neutral-900 rounded-2xl p-6\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            <h3 className=\"text-lg font-bold text-content dark:text-white mb-2\">\r\n              Delete Account?\r\n            </h3>\r\n            <p className=\"text-sm text-neutral-500 mb-6\">\r\n              Are you sure you want to delete your account? This action cannot\r\n              be undone.\r\n            </p>\r\n            <div className=\"flex gap-3\">\r\n              <button\r\n                onClick={() => setShowDeleteModal(false)}\r\n                className=\"flex-1 py-2.5 rounded-full bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white text-sm font-medium hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button className=\"flex-1 py-2.5 rounded-full bg-red-500 text-white text-sm font-medium hover:bg-red-600 transition-colors\">\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Password Change Modal */}\r\n      {showPasswordModal && (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm\"\r\n          onClick={() => setShowPasswordModal(false)}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-md mx-4 bg-white dark:bg-neutral-900 rounded-2xl p-6\"\r\n            onClick={e => e.stopPropagation()}\r\n          >\r\n            <h3 className=\"text-lg font-bold text-content dark:text-white mb-4\">\r\n              ƒê·ªïi m·∫≠t kh·∫©u\r\n            </h3>\r\n            <div className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <label className=\"text-sm font-medium text-content dark:text-white\">\r\n                  M·∫≠t kh·∫©u hi·ªán t·∫°i\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  value={passwordData.currentPassword}\r\n                  onChange={e =>\r\n                    setPasswordData({\r\n                      ...passwordData,\r\n                      currentPassword: e.target.value,\r\n                    })\r\n                  }\r\n                  placeholder=\"Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i\"\r\n                  className=\"w-full px-4 py-2.5 rounded-xl bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white placeholder:text-neutral-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50\"\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <label className=\"text-sm font-medium text-content dark:text-white\">\r\n                  M·∫≠t kh·∫©u m·ªõi\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  value={passwordData.newPassword}\r\n                  onChange={e =>\r\n                    setPasswordData({\r\n                      ...passwordData,\r\n                      newPassword: e.target.value,\r\n                    })\r\n                  }\r\n                  placeholder=\"Nh·∫≠p m·∫≠t kh·∫©u m·ªõi (√≠t nh·∫•t 6 k√Ω t·ª±)\"\r\n                  className=\"w-full px-4 py-2.5 rounded-xl bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white placeholder:text-neutral-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50\"\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <label className=\"text-sm font-medium text-content dark:text-white\">\r\n                  X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi\r\n                </label>\r\n                <input\r\n                  type=\"password\"\r\n                  value={passwordData.confirmPassword}\r\n                  onChange={e =>\r\n                    setPasswordData({\r\n                      ...passwordData,\r\n                      confirmPassword: e.target.value,\r\n                    })\r\n                  }\r\n                  placeholder=\"Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi\"\r\n                  className=\"w-full px-4 py-2.5 rounded-xl bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white placeholder:text-neutral-400 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50\"\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"flex gap-3 mt-6\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowPasswordModal(false);\r\n                  setPasswordData({\r\n                    currentPassword: '',\r\n                    newPassword: '',\r\n                    confirmPassword: '',\r\n                  });\r\n                }}\r\n                className=\"flex-1 py-2.5 rounded-full bg-neutral-100 dark:bg-neutral-800 text-content dark:text-white text-sm font-medium hover:bg-neutral-200 dark:hover:bg-neutral-700 transition-colors\"\r\n              >\r\n                H·ªßy\r\n              </button>\r\n              <button\r\n                onClick={handleUpdatePassword}\r\n                disabled={loading}\r\n                className=\"flex-1 py-2.5 rounded-full bg-primary text-primary-foreground text-sm font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center\"\r\n              >\r\n                {loading ? (\r\n                  <div className=\"w-5 h-5 border-2 border-white/30 dark:border-black/30 border-t-white dark:border-t-black rounded-full animate-spin\" />\r\n                ) : (\r\n                  'X√°c nh·∫≠n'\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AccountSettings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\BlockedMutedSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\FollowRequestsSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\NotificationSettings.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":88,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":88,"endColumn":41,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[2597,2608],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport {\r\n  Bell,\r\n  Heart,\r\n  MessageCircle,\r\n  UserPlus,\r\n  AtSign,\r\n  Mail,\r\n  Loader2,\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { useSettings, useUpdateSettings } from '@/hooks/useUserQuery';\r\nimport LoadingSpinner from '@/components/Common/LoadingSpinner';\r\n\r\nconst NotificationSettings = () => {\r\n  const { data: settingsData, isLoading: settingsLoading } = useSettings();\r\n  const updateSettingsMutation = useUpdateSettings();\r\n\r\n  const [notifications, setNotifications] = useState({\r\n    likes: true,\r\n    comments: true,\r\n    follows: true,\r\n    mentions: true,\r\n    messages: true,\r\n    email: false,\r\n    push: true,\r\n  });\r\n\r\n  // Sync local state with server settings\r\n  useEffect(() => {\r\n    if (settingsData?.notifications) {\r\n      const apiSettings = { ...settingsData.notifications };\r\n\r\n      // Handle legacy/nested structure where email/push might be objects\r\n      if (typeof apiSettings.email === 'object' && apiSettings.email !== null) {\r\n        apiSettings.email = apiSettings.email.enabled;\r\n      }\r\n      if (typeof apiSettings.push === 'object' && apiSettings.push !== null) {\r\n        apiSettings.push = apiSettings.push.enabled;\r\n      }\r\n\r\n      setNotifications(prev => ({\r\n        ...prev,\r\n        ...apiSettings,\r\n      }));\r\n    }\r\n  }, [settingsData]);\r\n\r\n  const handleToggle = async settingKey => {\r\n    const newNotifications = {\r\n      ...notifications,\r\n      [settingKey]: !notifications[settingKey],\r\n    };\r\n\r\n    setNotifications(newNotifications);\r\n\r\n    try {\r\n      await updateSettingsMutation.mutateAsync({\r\n        type: 'notifications',\r\n        settings: newNotifications,\r\n      });\r\n      toast.success('ƒê√£ l∆∞u c√†i ƒë·∫∑t th√¥ng b√°o');\r\n    } catch (error) {\r\n      // Revert on failure\r\n      setNotifications(notifications);\r\n      toast.error(error?.response?.data?.message || 'L∆∞u c√†i ƒë·∫∑t th·∫•t b·∫°i');\r\n    }\r\n  };\r\n\r\n  const ToggleSwitch = ({ enabled, onChange, disabled }) => (\r\n    <button\r\n      onClick={onChange}\r\n      disabled={disabled}\r\n      className={`relative w-11 h-6 rounded-full transition-colors ${\r\n        disabled ? 'opacity-50 cursor-not-allowed' : ''\r\n      } ${enabled ? 'bg-primary' : 'bg-neutral-200 dark:bg-neutral-700'}`}\r\n    >\r\n      <div\r\n        className={`absolute top-0.5 w-5 h-5 rounded-full transition-transform ${\r\n          enabled\r\n            ? 'translate-x-5 bg-primary-foreground'\r\n            : 'translate-x-0.5 bg-white dark:bg-neutral-400'\r\n        }`}\r\n      />\r\n    </button>\r\n  );\r\n\r\n  const NotificationItem = ({ icon: Icon, label, description, settingKey }) => (\r\n    <div className=\"flex items-center justify-between py-4 last:border-0\">\r\n      <div className=\"flex items-center gap-3\">\r\n        <div className=\"w-10 h-10 rounded-full bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center\">\r\n          <Icon size={18} className=\"text-neutral-500\" />\r\n        </div>\r\n        <div>\r\n          <p className=\"text-sm font-medium text-content dark:text-white\">\r\n            {label}\r\n          </p>\r\n          <p className=\"text-xs text-neutral-500\">{description}</p>\r\n        </div>\r\n      </div>\r\n      <ToggleSwitch\r\n        enabled={notifications[settingKey]}\r\n        onChange={() => handleToggle(settingKey)}\r\n        disabled={updateSettingsMutation.isPending}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  if (settingsLoading && !settingsData) {\r\n    return (\r\n      <div className=\"flex justify-center items-center py-16\">\r\n        <LoadingSpinner size=\"md\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      <div>\r\n        <h1 className=\"text-2xl font-bold text-content dark:text-white mb-2\">\r\n          Notifications\r\n        </h1>\r\n        <p className=\"text-neutral-500 text-sm\">\r\n          Choose what notifications you want to receive\r\n        </p>\r\n      </div>\r\n\r\n      {/* Activity Notifications */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-neutral-50/50 dark:bg-neutral-800/20\">\r\n        <div className=\"px-4 py-3 bg-neutral-100/50 dark:bg-neutral-700/30\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Bell size={16} className=\"text-neutral-500\" />\r\n            <h3 className=\"text-sm font-medium text-content dark:text-white\">\r\n              Activity\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4\">\r\n          <NotificationItem\r\n            icon={Heart}\r\n            label=\"Likes\"\r\n            description=\"When someone likes your post\"\r\n            settingKey=\"likes\"\r\n          />\r\n          <NotificationItem\r\n            icon={MessageCircle}\r\n            label=\"Comments\"\r\n            description=\"When someone comments on your post\"\r\n            settingKey=\"comments\"\r\n          />\r\n          <NotificationItem\r\n            icon={UserPlus}\r\n            label=\"New Followers\"\r\n            description=\"When someone follows you\"\r\n            settingKey=\"follows\"\r\n          />\r\n          <NotificationItem\r\n            icon={AtSign}\r\n            label=\"Mentions\"\r\n            description=\"When someone mentions you\"\r\n            settingKey=\"mentions\"\r\n          />\r\n          <NotificationItem\r\n            icon={MessageCircle}\r\n            label=\"Messages\"\r\n            description=\"When you receive a new message\"\r\n            settingKey=\"messages\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Delivery Methods */}\r\n      <div className=\"rounded-2xl overflow-hidden bg-neutral-50/50 dark:bg-neutral-800/20\">\r\n        <div className=\"px-4 py-3 bg-neutral-100/50 dark:bg-neutral-700/30\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Mail size={16} className=\"text-neutral-500\" />\r\n            <h3 className=\"text-sm font-medium text-content dark:text-white\">\r\n              Delivery Methods\r\n            </h3>\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4\">\r\n          <div className=\"flex items-center justify-between py-4\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                Push Notifications\r\n              </p>\r\n              <p className=\"text-xs text-neutral-500\">\r\n                Receive notifications on your device\r\n              </p>\r\n            </div>\r\n            <ToggleSwitch\r\n              enabled={notifications.push}\r\n              onChange={() => handleToggle('push')}\r\n              disabled={updateSettingsMutation.isPending}\r\n            />\r\n          </div>\r\n          <div className=\"flex items-center justify-between py-4\">\r\n            <div>\r\n              <p className=\"text-sm font-medium text-content dark:text-white\">\r\n                Email Notifications\r\n              </p>\r\n              <p className=\"text-xs text-neutral-500\">\r\n                Receive notifications via email\r\n              </p>\r\n            </div>\r\n            <ToggleSwitch\r\n              enabled={notifications.email}\r\n              onChange={() => handleToggle('email')}\r\n              disabled={updateSettingsMutation.isPending}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Saving indicator */}\r\n      {updateSettingsMutation.isPending && (\r\n        <div className=\"flex items-center justify-center gap-2 text-sm text-neutral-500\">\r\n          <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n          <span>ƒêang l∆∞u...</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationSettings;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\PrivacySettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\ProfileSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\SecuritySettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\SettingsLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\settings\\SideBarSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\FollowList\\FollowList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\FollowingUser.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\Friends.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\HomeProfile.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\Profile.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\ProfileLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\SavePosts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\SideBarProfile.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\Profiles\\SuggestFriends.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\components\\features\\user\\TopUser\\TopUser.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":38,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport { UserPlus, Check, Loader2 } from 'lucide-react';\r\nimport { useFollowUser, useUnfollowUser } from '@/hooks/useUserQuery';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst TopUser = ({ users = [], loading = false }) => {\r\n  const { user: currentUser } = useSelector(state => state.auth);\r\n  const [followingIds, setFollowingIds] = useState(new Set());\r\n  const [loadingIds, setLoadingIds] = useState(new Set());\r\n\r\n  const { mutateAsync: followUser } = useFollowUser();\r\n  const { mutateAsync: unfollowUser } = useUnfollowUser();\r\n\r\n  const handleFollow = async (e, userId, isFollowed) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (loadingIds.has(userId)) return;\r\n\r\n    setLoadingIds(prev => new Set(prev).add(userId));\r\n\r\n    try {\r\n      if (isFollowed) {\r\n        await unfollowUser(userId);\r\n        setFollowingIds(prev => {\r\n          const next = new Set(prev);\r\n          next.delete(userId);\r\n          return next;\r\n        });\r\n        toast.success('ƒê√£ b·ªè theo d√µi');\r\n      } else {\r\n        await followUser(userId);\r\n        setFollowingIds(prev => new Set(prev).add(userId));\r\n        toast.success('ƒê√£ theo d√µi');\r\n      }\r\n    } catch (error) {\r\n      toast.error('C√≥ l·ªói x·∫£y ra');\r\n    } finally {\r\n      setLoadingIds(prev => {\r\n        const next = new Set(prev);\r\n        next.delete(userId);\r\n        return next;\r\n      });\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center py-4\">\r\n        <Loader2 className=\"w-5 h-5 animate-spin text-neutral-400\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!users || users.length === 0) {\r\n    return (\r\n      <p className=\"text-center text-xs text-neutral-400 py-4\">\r\n        Kh√¥ng c√≥ g·ª£i √Ω\r\n      </p>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-1\">\r\n      {users.map(user => {\r\n        const isFollowed = followingIds.has(user._id) || user.isFollowing;\r\n        const isLoading = loadingIds.has(user._id);\r\n        const isSelf = currentUser?._id === user._id;\r\n\r\n        return (\r\n          <Link\r\n            key={user._id}\r\n            to={`/profile/${user._id}`}\r\n            className=\"px-2 py-2 rounded-xl hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer transition-all flex items-center gap-3 group\"\r\n          >\r\n            {/* Avatar */}\r\n            <div className=\"relative flex-shrink-0\">\r\n              <img\r\n                src={\r\n                  user.avatar ||\r\n                  `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.username}`\r\n                }\r\n                alt={user.name || user.username}\r\n                className=\"w-10 h-10 rounded-full object-cover\"\r\n              />\r\n              {user.isVerified && (\r\n                <div className=\"absolute -bottom-0.5 -right-0.5 w-4 h-4 rounded-full bg-black dark:bg-white flex items-center justify-center\">\r\n                  <Check size={8} className=\"text-white dark:text-black\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* User Info */}\r\n            <div className=\"flex-1 min-w-0\">\r\n              <div className=\"flex items-center gap-1.5\">\r\n                <span className=\"text-sm font-medium text-black dark:text-white truncate\">\r\n                  {user.name || user.username}\r\n                </span>\r\n              </div>\r\n              <span className=\"text-xs text-neutral-500 truncate block\">\r\n                @{user.username}\r\n              </span>\r\n            </div>\r\n\r\n            {/* Follow Button - Hide if self */}\r\n            {!isSelf && (\r\n              <button\r\n                onClick={e => handleFollow(e, user._id, isFollowed)}\r\n                disabled={isLoading}\r\n                className={`flex items-center gap-1 text-xs px-3 py-1.5 rounded-full font-medium flex-shrink-0 transition-colors disabled:opacity-50 ${\r\n                  isFollowed\r\n                    ? 'bg-neutral-200 dark:bg-neutral-800 text-black dark:text-white'\r\n                    : 'bg-primary text-primary-foreground'\r\n                }`}\r\n              >\r\n                {isLoading ? (\r\n                  <Loader2 size={12} className=\"animate-spin\" />\r\n                ) : isFollowed ? (\r\n                  <>\r\n                    <Check size={12} />\r\n                    <span>Following</span>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <UserPlus size={12} />\r\n                    <span>Follow</span>\r\n                  </>\r\n                )}\r\n              </button>\r\n            )}\r\n          </Link>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TopUser;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\broadcast.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\privacy.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\report.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\route.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\constants\\socket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\contexts\\SocketContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":7,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":7,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport useSocket from '@/hooks/useSocket';\r\n\r\nconst SocketContext = createContext(null);\r\n\r\nexport const useSocketContext = () => useContext(SocketContext);\r\n\r\nexport const SocketProvider = ({ children }) => {\r\n  const { user } = useSelector(state => state.auth);\r\n  const userId = user?._id || user?.user?._id;\r\n\r\n  const socketData = useSocket(userId);\r\n\r\n  return (\r\n    <SocketContext.Provider value={socketData}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\n\r\nexport default SocketProvider;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useAdminQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useCommentQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useComments.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useDebounce.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useFeedQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useMessageQuery.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":133,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":133,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"_"},"fix":{"range":[4353,4354],"text":"()"},"desc":"Remove unused variable '_'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\r\n  useQuery,\r\n  useMutation,\r\n  useQueryClient,\r\n  useInfiniteQuery,\r\n} from '@tanstack/react-query';\r\nimport api from '@/axios/axiosConfig';\r\nimport { MESSAGE_API } from '@/axios/apiEndpoint';\r\nimport { extractData } from '@/utils/apiUtils';\r\n\r\n/**\r\n * Hook to fetch conversations list\r\n * @param {Object} [options] - Query options\r\n * @param {number} [options.page=1] - Page number\r\n * @param {number} [options.limit=20] - Items per page\r\n * @returns {import('@tanstack/react-query').UseQueryResult} Query result containing conversations\r\n */\r\nexport const useConversations = ({ page = 1, limit = 20 } = {}) => {\r\n  return useQuery({\r\n    queryKey: ['messages', 'conversations', { page, limit }],\r\n    queryFn: async () => {\r\n      const response = await api.get(MESSAGE_API.GET_CONVERSATIONS, {\r\n        params: { page, limit },\r\n      });\r\n      return extractData(response);\r\n    },\r\n    keepPreviousData: true,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to fetch messages in a conversation\r\n * @param {Object} [options] - Query options\r\n * @param {string} [options.conversationId] - Conversation ID\r\n * @param {number} [options.page=1] - Page number\r\n * @param {number} [options.limit=50] - Items per page\r\n * @returns {import('@tanstack/react-query').UseQueryResult} Query result containing messages\r\n */\r\nexport const useMessages = ({ conversationId, page = 1, limit = 50 } = {}) => {\r\n  return useQuery({\r\n    queryKey: ['messages', 'list', conversationId, { page, limit }],\r\n    queryFn: async () => {\r\n      if (!conversationId) return { messages: [], total: 0 };\r\n      const response = await api.get(MESSAGE_API.GET_MESSAGES(conversationId), {\r\n        params: { page, limit },\r\n      });\r\n      return extractData(response);\r\n    },\r\n    enabled: !!conversationId,\r\n    keepPreviousData: true,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to fetch messages with infinite scroll\r\n * @param {Object} [options] - Query options\r\n * @param {string} [options.conversationId] - Conversation ID\r\n * @param {number} [options.limit=50] - Items per page\r\n * @returns {import('@tanstack/react-query').UseInfiniteQueryResult} Infinite query result\r\n */\r\nexport const useInfiniteMessages = ({ conversationId, limit = 50 } = {}) => {\r\n  return useInfiniteQuery({\r\n    queryKey: ['messages', 'infinite', conversationId],\r\n    queryFn: async ({ pageParam = 1 }) => {\r\n      const response = await api.get(MESSAGE_API.GET_MESSAGES(conversationId), {\r\n        params: { page: pageParam, limit },\r\n      });\r\n      return extractData(response);\r\n    },\r\n    getNextPageParam: (lastPage, allPages) => {\r\n      return lastPage.hasMore ? allPages.length + 1 : undefined;\r\n    },\r\n    enabled: !!conversationId,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to send a message\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to send message\r\n */\r\nexport const useSendMessage = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      conversationId,\r\n      content,\r\n      type = 'text',\r\n      attachments,\r\n    }) => {\r\n      const formData = new FormData();\r\n      formData.append('conversationId', conversationId);\r\n      formData.append('content', content);\r\n      formData.append('type', type);\r\n      if (attachments) {\r\n        attachments.forEach(file => {\r\n          formData.append('attachments', file);\r\n        });\r\n      }\r\n      const response = await api.post(MESSAGE_API.SEND, formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n      });\r\n      return extractData(response);\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries([\r\n        'messages',\r\n        'list',\r\n        variables.conversationId,\r\n      ]);\r\n      queryClient.invalidateQueries([\r\n        'messages',\r\n        'infinite',\r\n        variables.conversationId,\r\n      ]);\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to mark conversation as read\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to mark as read\r\n */\r\nexport const useMarkAsRead = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async conversationId => {\r\n      await api.post(MESSAGE_API.MARK_CONVERSATION_READ(conversationId));\r\n      return conversationId;\r\n    },\r\n    onSuccess: _ => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n      queryClient.invalidateQueries(['messages', 'unreadCount']);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to fetch unread messages count\r\n * @returns {import('@tanstack/react-query').UseQueryResult} Query result containing unread count\r\n */\r\nexport const useUnreadMessagesCount = () => {\r\n  return useQuery({\r\n    queryKey: ['messages', 'unreadCount'],\r\n    queryFn: async () => {\r\n      const response = await api.get(MESSAGE_API.GET_UNREAD_COUNT);\r\n      const data = extractData(response);\r\n      return data?.unreadCount ?? data?.count ?? data ?? 0;\r\n    },\r\n    refetchInterval: 1000 * 60,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to fetch conversation media\r\n * @param {string} conversationId - Conversation ID\r\n * @returns {import('@tanstack/react-query').UseQueryResult} Query result containing media list\r\n */\r\nexport const useConversationMedia = conversationId => {\r\n  return useQuery({\r\n    queryKey: ['messages', 'media', conversationId],\r\n    queryFn: async () => {\r\n      const response = await api.get(MESSAGE_API.GET_MEDIA(conversationId));\r\n      return extractData(response);\r\n    },\r\n    enabled: !!conversationId,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to fetch conversation by ID\r\n * @param {string} conversationId - Conversation ID\r\n * @returns {import('@tanstack/react-query').UseQueryResult} Query result containing conversation info\r\n */\r\nexport const useConversationById = conversationId => {\r\n  return useQuery({\r\n    queryKey: ['messages', 'conversation', conversationId],\r\n    queryFn: async () => {\r\n      const response = await api.get(\r\n        MESSAGE_API.GET_CONVERSATION(conversationId)\r\n      );\r\n      return extractData(response);\r\n    },\r\n    enabled: !!conversationId && conversationId.length === 24,\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to create a new conversation\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to create conversation\r\n */\r\nexport const useCreateConversation = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async participantId => {\r\n      const response = await api.post(MESSAGE_API.CREATE_CONVERSATION, {\r\n        participantId,\r\n      });\r\n      return extractData(response);\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to create a group chat\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to create group\r\n */\r\nexport const useCreateGroup = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ name, participantIds }) => {\r\n      const response = await api.post(MESSAGE_API.CREATE_GROUP, {\r\n        name,\r\n        participantIds,\r\n      });\r\n      return extractData(response);\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to delete a message\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to delete message\r\n */\r\nexport const useDeleteMessage = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ conversationId, messageId }) => {\r\n      await api.delete(MESSAGE_API.DELETE_MESSAGE(messageId));\r\n      return { conversationId, messageId };\r\n    },\r\n    onSuccess: data => {\r\n      queryClient.invalidateQueries(['messages', 'list', data.conversationId]);\r\n      queryClient.invalidateQueries([\r\n        'messages',\r\n        'infinite',\r\n        data.conversationId,\r\n      ]);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to update group information\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to update group\r\n */\r\nexport const useUpdateGroup = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ groupId, data }) => {\r\n      const response = await api.put(MESSAGE_API.UPDATE_GROUP(groupId), data);\r\n      return extractData(response);\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n      queryClient.invalidateQueries([\r\n        'messages',\r\n        'conversation',\r\n        variables.groupId,\r\n      ]);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to add member to group\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to add member\r\n */\r\nexport const useAddGroupMember = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ groupId, memberIds }) => {\r\n      const response = await api.post(MESSAGE_API.ADD_MEMBERS(groupId), {\r\n        memberIds,\r\n      });\r\n      return extractData(response);\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries([\r\n        'messages',\r\n        'conversation',\r\n        variables.groupId,\r\n      ]);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to remove member from group\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to remove member\r\n */\r\nexport const useRemoveGroupMember = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async ({ groupId, userId }) => {\r\n      await api.delete(MESSAGE_API.REMOVE_MEMBER(groupId, userId));\r\n      return { groupId, userId };\r\n    },\r\n    onSuccess: data => {\r\n      queryClient.invalidateQueries(['messages', 'conversation', data.groupId]);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to leave a group\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to leave group\r\n */\r\nexport const useLeaveGroup = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async groupId => {\r\n      await api.post(MESSAGE_API.LEAVE_GROUP(groupId));\r\n      return groupId;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n    },\r\n  });\r\n};\r\n\r\n/**\r\n * Hook to delete a conversation\r\n * @returns {import('@tanstack/react-query').UseMutationResult} Mutation to delete conversation\r\n */\r\nexport const useDeleteConversation = () => {\r\n  const queryClient = useQueryClient();\r\n  return useMutation({\r\n    mutationFn: async conversationId => {\r\n      await api.delete(MESSAGE_API.DELETE_CONVERSATION(conversationId));\r\n      return conversationId;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(['messages', 'conversations']);\r\n    },\r\n  });\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useNotificationQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\usePostsQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useReportQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useSearchQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useSocket.js","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'activeRooms.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'activeRooms.current' to a variable inside the effect, and use that variable in the cleanup function.","line":86,"column":21,"nodeType":"Identifier","endLine":86,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef, useState, useCallback, useMemo } from 'react';\r\nimport { useQueryClient } from '@tanstack/react-query';\r\nimport io from 'socket.io-client';\r\nimport { toast } from 'react-hot-toast';\r\nimport { SOCKET_URL, MAX_RECONNECT_ATTEMPTS } from '@/constants/socket';\r\n\r\n/**\r\n * Hook to manage Socket.IO connection\r\n * @param {string} userId - Current user ID\r\n * @returns {Object} Socket instance and utility functions\r\n * @returns {Object|null} returns.socket - Socket.IO instance\r\n * @returns {Function} returns.joinRoom - Join room function\r\n * @returns {Function} returns.leaveRoom - Leave room function\r\n * @returns {Function} returns.sendMessage - Send message function\r\n * @returns {Function} returns.emitEvent - Emit custom event function\r\n * @returns {Function} returns.joinPostRoom - Join post room function\r\n * @returns {Function} returns.emitLikeAction - Emit like action function\r\n * @returns {boolean} returns.isConnected - Connection status\r\n * @returns {Object} returns.onlineUsers - Online users map\r\n * @returns {Function} returns.isUserOnline - Check user online function\r\n */\r\nconst useSocket = userId => {\r\n  const socketRef = useRef(null);\r\n  const queryClient = useQueryClient();\r\n  const reconnectAttempts = useRef(0);\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const activeRooms = useRef(new Set());\r\n  const [onlineUsers, setOnlineUsers] = useState({});\r\n\r\n  useEffect(() => {\r\n    if (!userId) return;\r\n\r\n    const socket = io(SOCKET_URL, {\r\n      withCredentials: true,\r\n      reconnection: true,\r\n      reconnectionDelay: 1000,\r\n      reconnectionDelayMax: 5000,\r\n      reconnectionAttempts: MAX_RECONNECT_ATTEMPTS,\r\n      path: '/socket.io/',\r\n    });\r\n\r\n    socketRef.current = socket;\r\n\r\n    socket.on('connect', () => {\r\n      reconnectAttempts.current = 0;\r\n      setIsConnected(true);\r\n\r\n      socket.emit('register_user', { userId });\r\n      socket.emit('join_room', userId);\r\n      activeRooms.current.add(userId);\r\n      activeRooms.current.forEach(room => {\r\n        if (room !== userId) socket.emit('join_room', room);\r\n      });\r\n\r\n      socket.emit('get_online_users');\r\n      queryClient.invalidateQueries(['messages', 'unreadCount']);\r\n      queryClient.invalidateQueries(['notifications', 'unreadCount']);\r\n    });\r\n\r\n    socket.on('disconnect', reason => {\r\n      setIsConnected(false);\r\n      if (reason === 'io server disconnect') {\r\n        setTimeout(() => socket.connect(), 1000);\r\n      }\r\n    });\r\n\r\n    socket.on('connect_error', () => {\r\n      setIsConnected(false);\r\n      reconnectAttempts.current++;\r\n      if (reconnectAttempts.current >= MAX_RECONNECT_ATTEMPTS) {\r\n        toast.error('Unable to connect to chat server');\r\n      }\r\n    });\r\n\r\n    registerMessageHandlers(socket, userId, queryClient);\r\n    registerNotificationHandlers(socket, queryClient);\r\n    registerLikeHandlers(socket, userId, queryClient);\r\n    registerCommentHandlers(socket, userId, queryClient);\r\n    registerUserStatusHandlers(socket, setOnlineUsers);\r\n\r\n    return () => {\r\n      if (socket) {\r\n        socket.disconnect();\r\n        socketRef.current = null;\r\n        setIsConnected(false);\r\n        activeRooms.current.clear();\r\n      }\r\n    };\r\n  }, [userId, queryClient]);\r\n\r\n  /**\r\n   * Join a room\r\n   * @param {string} roomId - Room ID\r\n   */\r\n  const joinRoom = useCallback(roomId => {\r\n    if (!roomId) return;\r\n    if (activeRooms.current.has(roomId)) return;\r\n\r\n    if (socketRef.current?.connected) {\r\n      socketRef.current.emit('join_room', roomId);\r\n    }\r\n    activeRooms.current.add(roomId);\r\n  }, []);\r\n\r\n  /**\r\n   * Leave a room\r\n   * @param {string} roomId - Room ID\r\n   */\r\n  const leaveRoom = useCallback(roomId => {\r\n    if (!roomId) return;\r\n    if (!activeRooms.current.has(roomId)) return;\r\n\r\n    activeRooms.current.delete(roomId);\r\n    if (socketRef.current?.connected) {\r\n      socketRef.current.emit('leave_room', roomId);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Send message via socket\r\n   * @param {Object} data - Message data\r\n   * @returns {boolean} Send result\r\n   */\r\n  const sendMessage = useCallback(data => {\r\n    if (!socketRef.current?.connected) return false;\r\n    socketRef.current.emit('send_message', data);\r\n    return true;\r\n  }, []);\r\n\r\n  /**\r\n   * Emit custom event\r\n   * @param {string} event - Event name\r\n   * @param {*} data - Event data\r\n   * @returns {boolean} Emit result\r\n   */\r\n  const emitEvent = useCallback((event, data) => {\r\n    if (!socketRef.current?.connected) return false;\r\n    socketRef.current.emit(event, data);\r\n    return true;\r\n  }, []);\r\n\r\n  /**\r\n   * Join post room to receive updates\r\n   * @param {string} postId - Post ID\r\n   */\r\n  const joinPostRoom = useCallback(\r\n    postId => {\r\n      if (!postId) return;\r\n      joinRoom(`post:${postId}`);\r\n      emitEvent('post:like:listen', postId);\r\n    },\r\n    [joinRoom, emitEvent]\r\n  );\r\n\r\n  /**\r\n   * Emit like action for post\r\n   * @param {string} postId - Post ID\r\n   * @param {string} action - Action ('like' | 'unlike')\r\n   */\r\n  const emitLikeAction = useCallback(\r\n    (postId, action) => {\r\n      emitEvent('post:like', { postId, userId, action });\r\n    },\r\n    [emitEvent, userId]\r\n  );\r\n\r\n  /**\r\n   * Check if user is online\r\n   * @param {string} uid - User ID to check\r\n   * @returns {boolean} Online status\r\n   */\r\n  const isUserOnline = useCallback(\r\n    uid => {\r\n      if (!uid) return false;\r\n      return !!onlineUsers[uid.toString()];\r\n    },\r\n    [onlineUsers]\r\n  );\r\n\r\n  return useMemo(\r\n    () => ({\r\n      socket: socketRef.current,\r\n      joinRoom,\r\n      leaveRoom,\r\n      sendMessage,\r\n      emitEvent,\r\n      joinPostRoom,\r\n      emitLikeAction,\r\n      isConnected,\r\n      onlineUsers,\r\n      isUserOnline,\r\n    }),\r\n    [\r\n      joinRoom,\r\n      leaveRoom,\r\n      sendMessage,\r\n      emitEvent,\r\n      joinPostRoom,\r\n      emitLikeAction,\r\n      isConnected,\r\n      onlineUsers,\r\n      isUserOnline,\r\n    ]\r\n  );\r\n};\r\n\r\n/**\r\n * Register message handlers\r\n * @param {Object} socket - Socket instance\r\n * @param {string} userId - Current user ID\r\n * @param {Object} queryClient - React Query client\r\n */\r\nconst registerMessageHandlers = (socket, userId, queryClient) => {\r\n  socket.on('new_message', message => {\r\n    if (!message?._id) return;\r\n\r\n    const senderId = message.sender?._id || message.sender;\r\n    const isMine =\r\n      senderId && userId && senderId.toString() === userId.toString();\r\n\r\n    queryClient.invalidateQueries(['messages', 'list', message.conversationId]);\r\n    queryClient.invalidateQueries([\r\n      'messages',\r\n      'infinite',\r\n      message.conversationId,\r\n    ]);\r\n    queryClient.invalidateQueries(['messages', 'conversations']);\r\n    queryClient.invalidateQueries(['messages', 'unreadCount']);\r\n\r\n    if (!isMine) {\r\n      const senderName =\r\n        message.sender?.firstName || message.sender?.name || 'User';\r\n      toast.success(`New message from ${senderName}`);\r\n    }\r\n  });\r\n\r\n  socket.on('message_read', data => {\r\n    if (data?.messageId) {\r\n      queryClient.invalidateQueries(['messages']);\r\n    }\r\n  });\r\n\r\n  socket.on('user_typing', () => {});\r\n  socket.on('user_stop_typing', () => {});\r\n};\r\n\r\n/**\r\n * Register notification handlers\r\n * @param {Object} socket - Socket instance\r\n * @param {Object} queryClient - React Query client\r\n */\r\nconst registerNotificationHandlers = (socket, queryClient) => {\r\n  const handleNotification = notification => {\r\n    if (!notification?._id) {\r\n      queryClient.invalidateQueries(['notifications', 'unreadCount']);\r\n      return;\r\n    }\r\n\r\n    queryClient.invalidateQueries(['notifications']);\r\n    queryClient.invalidateQueries(['notifications', 'unreadCount']);\r\n\r\n    let msg = notification.content || 'You have a new notification';\r\n    if (notification.type === 'like' && notification.post?.caption) {\r\n      msg += ` - \"${notification.post.caption.substring(0, 20)}...\"`;\r\n    }\r\n    toast.success(msg, { icon: 'üîî' });\r\n  };\r\n\r\n  socket.on('notification:new', handleNotification);\r\n  socket.on('new_notification', handleNotification);\r\n};\r\n\r\n/**\r\n * Register like handlers\r\n * @param {Object} socket - Socket instance\r\n * @param {string} currentUserId - Current user ID\r\n * @param {Object} queryClient - React Query client\r\n */\r\nconst registerLikeHandlers = (socket, currentUserId, queryClient) => {\r\n  socket.on('post:like:update', ({ postId, userId }) => {\r\n    if (userId === currentUserId) return;\r\n\r\n    queryClient.invalidateQueries(['feed']);\r\n    queryClient.invalidateQueries(['posts']);\r\n    queryClient.invalidateQueries(['post', postId]);\r\n    queryClient.invalidateQueries(['likeStatus', postId]);\r\n  });\r\n};\r\n\r\n/**\r\n * Register user status handlers\r\n * @param {Object} socket - Socket instance\r\n * @param {Function} setOnlineUsers - Online users state setter\r\n */\r\nconst registerUserStatusHandlers = (socket, setOnlineUsers) => {\r\n  socket.on('get_users_online', users => {\r\n    const map = {};\r\n    if (Array.isArray(users)) users.forEach(id => (map[id] = true));\r\n    else Object.assign(map, users || {});\r\n    setOnlineUsers(map);\r\n  });\r\n\r\n  socket.on('user_status_change', ({ userId, status }) => {\r\n    setOnlineUsers(prev => ({ ...prev, [userId]: status === 'online' }));\r\n  });\r\n};\r\n\r\n/**\r\n * Register comment handlers\r\n * @param {Object} socket - Socket instance\r\n * @param {string} currentUserId - Current user ID\r\n * @param {Object} queryClient - React Query client\r\n */\r\nconst registerCommentHandlers = (socket, currentUserId, queryClient) => {\r\n  socket.on('new_comment', data => {\r\n    const { postId, userId } = data;\r\n    if (userId === currentUserId) return;\r\n\r\n    queryClient.invalidateQueries(['post', postId]);\r\n    queryClient.invalidateQueries(['comments', postId]);\r\n    queryClient.invalidateQueries(['posts']);\r\n    queryClient.invalidateQueries(['feed']);\r\n  });\r\n\r\n  socket.on('delete_comment', data => {\r\n    const { postId, userId } = data;\r\n    if (userId === currentUserId) return;\r\n\r\n    queryClient.invalidateQueries(['post', postId]);\r\n    queryClient.invalidateQueries(['comments', postId]);\r\n    queryClient.invalidateQueries(['posts']);\r\n    queryClient.invalidateQueries(['feed']);\r\n  });\r\n};\r\n\r\nexport default useSocket;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\hooks\\useUserQuery.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AdminPage\\AdminPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\AdminRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\AuthLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\EnterCode.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\ForgotPassword.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\Login.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'clearError' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"clearError"},"fix":{"range":[335,389],"text":""},"desc":"Remove unused variable 'clearError'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useCallback, useEffect } from 'react';\r\nimport { Link, Navigate, useNavigate } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Sparkles, Mail, Lock, Eye, EyeOff, AlertCircle } from 'lucide-react';\r\nimport { login, googleAuth } from '@/redux/actions/authActions';\r\nimport { clearError } from '@/redux/slices/AuthSlice';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Login = () => {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const googleButtonRef = useRef(null);\r\n  const googleInitialized = useRef(false);\r\n  const { loading, error, isAuthenticated, user } = useSelector(\r\n    state => state.auth\r\n  );\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    email: '',\r\n    password: '',\r\n  });\r\n\r\n  // Redirect if already authenticated AND user data is loaded\r\n  useEffect(() => {\r\n    if (isAuthenticated && user) {\r\n      navigate('/', { replace: true });\r\n    }\r\n  }, [isAuthenticated, user, navigate]);\r\n\r\n  // Clear error on unmount\r\n\r\n  // Initialize Google Sign-In\r\n  const initGoogle = useCallback(() => {\r\n    if (\r\n      googleInitialized.current ||\r\n      !window.google?.accounts?.id ||\r\n      !googleButtonRef.current\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    googleInitialized.current = true;\r\n\r\n    window.google.accounts.id.initialize({\r\n      client_id: import.meta.env.VITE_GOOGLE_CLIENT_ID,\r\n      callback: async response => {\r\n        if (response.credential) {\r\n          const result = await dispatch(googleAuth(response.credential));\r\n          if (googleAuth.fulfilled.match(result)) {\r\n            toast.success('ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng!');\r\n          } else {\r\n            toast.error('ƒêƒÉng nh·∫≠p Google th·∫•t b·∫°i');\r\n          }\r\n        }\r\n      },\r\n    });\r\n\r\n    window.google.accounts.id.renderButton(googleButtonRef.current, {\r\n      theme: 'outline',\r\n      size: 'large',\r\n      width: 320,\r\n      text: 'continue_with',\r\n      shape: 'pill',\r\n    });\r\n  }, [dispatch]);\r\n\r\n  // Setup Google button when ref is available\r\n  useEffect(() => {\r\n    if (!googleButtonRef.current) return;\r\n\r\n    // Try immediately\r\n    initGoogle();\r\n\r\n    // If not available, poll for it\r\n    if (!googleInitialized.current) {\r\n      const interval = setInterval(() => {\r\n        if (window.google?.accounts?.id) {\r\n          initGoogle();\r\n          clearInterval(interval);\r\n        }\r\n      }, 200);\r\n\r\n      const timeout = setTimeout(() => clearInterval(interval), 10000);\r\n      return () => {\r\n        clearInterval(interval);\r\n        clearTimeout(timeout);\r\n      };\r\n    }\r\n  }, [initGoogle]);\r\n\r\n  const handleChange = e => {\r\n    setFormData({ ...formData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    if (!formData.email || !formData.password) {\r\n      toast.error('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin');\r\n      return;\r\n    }\r\n    const result = await dispatch(login(formData));\r\n    if (login.fulfilled.match(result)) {\r\n      toast.success('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');\r\n    }\r\n  };\r\n\r\n  // No longer needed due to useEffect redirect above\r\n  // if (isAuthenticated && user) {\r\n  //   return <Navigate to=\"/\" replace />;\r\n  // }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex\">\r\n      {/* Left Panel - Branding */}\r\n      <div className=\"hidden lg:flex w-1/2 bg-black items-center justify-center relative overflow-hidden\">\r\n        <div className=\"absolute inset-0 bg-gradient-to-br from-black via-neutral-900 to-black\" />\r\n\r\n        {/* Decorative circles */}\r\n        <div className=\"absolute top-20 left-20 w-64 h-64 bg-white/5 rounded-full blur-3xl\" />\r\n        <div className=\"absolute bottom-20 right-20 w-96 h-96 bg-white/3 rounded-full blur-3xl\" />\r\n\r\n        <div className=\"relative z-10 text-center px-12\">\r\n          <div className=\"w-16 h-16 rounded-full bg-white flex items-center justify-center mx-auto mb-8\">\r\n            <Sparkles size={28} className=\"text-black\" />\r\n          </div>\r\n          <h1 className=\"text-5xl font-bold text-white mb-4 tracking-tight\">\r\n            YiBu\r\n          </h1>\r\n          <p className=\"text-white/60 text-lg max-w-sm mx-auto\">\r\n            Connect, share, and discover. Your social experience reimagined.\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right Panel - Form */}\r\n      <div className=\"w-full lg:w-1/2 flex items-center justify-center p-8 bg-white dark:bg-black\">\r\n        <div className=\"w-full max-w-md\">\r\n          {/* Mobile Logo */}\r\n          <div className=\"lg:hidden flex items-center justify-center mb-10\">\r\n            <div className=\"w-12 h-12 rounded-full bg-black dark:bg-white flex items-center justify-center\">\r\n              <Sparkles size={22} className=\"text-white dark:text-black\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mb-10\">\r\n            <h2 className=\"text-3xl font-bold text-content dark:text-white mb-2\">\r\n              Welcome back\r\n            </h2>\r\n            <p className=\"text-neutral-500\">Sign in to continue to YiBu</p>\r\n          </div>\r\n\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            {/* Email */}\r\n            <div className=\"space-y-2\">\r\n              <label className=\"text-sm font-medium text-content dark:text-white\">\r\n                Email\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Mail\r\n                  size={18}\r\n                  className=\"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-400\"\r\n                />\r\n                <input\r\n                  type=\"email\"\r\n                  name=\"email\"\r\n                  value={formData.email}\r\n                  onChange={handleChange}\r\n                  placeholder=\"name@example.com\"\r\n                  className=\"w-full pl-12 pr-4 py-3.5 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl text-content dark:text-white placeholder:text-neutral-400 focus:outline-none focus:border-primary transition-colors\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Password */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <label className=\"text-sm font-medium text-content dark:text-white\">\r\n                  Password\r\n                </label>\r\n                <Link\r\n                  to=\"/auth/forgot-password\"\r\n                  className=\"text-sm text-neutral-500 hover:text-black dark:hover:text-white transition-colors\"\r\n                >\r\n                  Forgot?\r\n                </Link>\r\n              </div>\r\n              <div className=\"relative\">\r\n                <Lock\r\n                  size={18}\r\n                  className=\"absolute left-4 top-1/2 -translate-y-1/2 text-neutral-400\"\r\n                />\r\n                <input\r\n                  type={showPassword ? 'text' : 'password'}\r\n                  name=\"password\"\r\n                  value={formData.password}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Enter your password\"\r\n                  className=\"w-full pl-12 pr-12 py-3.5 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-xl text-content dark:text-white placeholder:text-neutral-400 focus:outline-none focus:border-primary transition-colors\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowPassword(!showPassword)}\r\n                  className=\"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300\"\r\n                >\r\n                  {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Error Message */}\r\n            {error && (\r\n              <div className=\"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-600 dark:text-red-400 text-sm\">\r\n                <AlertCircle size={16} />\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {/* Submit */}\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading}\r\n              className=\"w-full py-3.5 bg-primary text-primary-foreground font-medium rounded-xl hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2\"\r\n            >\r\n              {loading ? (\r\n                <div className=\"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin\" />\r\n              ) : (\r\n                'Sign In'\r\n              )}\r\n            </button>\r\n\r\n            {/* Divider */}\r\n            <div className=\"relative flex items-center my-8\">\r\n              <div className=\"flex-1 border-t border-neutral-200 dark:border-neutral-800\" />\r\n              <span className=\"px-4 text-sm text-neutral-400\">or</span>\r\n              <div className=\"flex-1 border-t border-neutral-200 dark:border-neutral-800\" />\r\n            </div>\r\n\r\n            {/* Google Sign-In Button */}\r\n            <div className=\"flex justify-center\">\r\n              <div ref={googleButtonRef} />\r\n            </div>\r\n          </form>\r\n\r\n          {/* Footer */}\r\n          <p className=\"mt-10 text-center text-neutral-500\">\r\n            Don't have an account?{' '}\r\n            <Link\r\n              to=\"/auth/register\"\r\n              className=\"font-medium text-primary hover:underline\"\r\n            >\r\n              Sign up\r\n            </Link>\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\ProtectedRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\Register.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\AuthPage\\ResetPassword.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\ErrorPages\\AccessDenied.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\NotFound\\NotFound.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\Explore.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\HashtagPosts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\Home.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\Message.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'conversations' logical expression could make the dependencies of useEffect Hook (at line 92) change on every render. To fix this, wrap the initialization of 'conversations' in its own useMemo() Hook.","line":21,"column":9,"nodeType":"VariableDeclarator","endLine":22,"endColumn":64},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'conversations' logical expression could make the dependencies of useMemo Hook (at line 113) change on every render. To fix this, wrap the initialization of 'conversations' in its own useMemo() Hook.","line":21,"column":9,"nodeType":"VariableDeclarator","endLine":22,"endColumn":64}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from 'react';\r\nimport { useNavigate, Outlet, useParams } from 'react-router-dom';\r\nimport { useSelector } from 'react-redux';\r\nimport { Search, Settings, MessageCircle, Loader2, Users } from 'lucide-react';\r\nimport {\r\n  useConversations,\r\n  useCreateConversation,\r\n  useCreateGroup,\r\n} from '@/hooks/useMessageQuery';\r\nimport { useSearchUsers } from '@/hooks/useSearchQuery';\r\nimport ConversationItem from '@/components/features/chat/ConversationItem';\r\nimport CreateGroupModal from '@/components/features/chat/CreateGroupModal';\r\nimport { useDebounce } from '@/hooks/useDebounce';\r\n\r\nfunction Message() {\r\n  const navigate = useNavigate();\r\n  const { conversationId } = useParams();\r\n\r\n  const { data: conversationsData, isLoading: conversationsLoading } =\r\n    useConversations();\r\n  const conversations =\r\n    conversationsData?.conversations || conversationsData || [];\r\n\r\n  const { user } = useSelector(state => state.auth);\r\n\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [showGroupModal, setShowGroupModal] = useState(false);\r\n  const [groupName, setGroupName] = useState('');\r\n  const [userSearchTerm, setUserSearchTerm] = useState('');\r\n  const [selectedUsers, setSelectedUsers] = useState([]);\r\n  const debouncedUserSearch = useDebounce(userSearchTerm, 500);\r\n\r\n  const createConversationMutation = useCreateConversation();\r\n  const createGroupMutation = useCreateGroup();\r\n\r\n  const { data: searchResultsData, isLoading: isSearchingUsers } =\r\n    useSearchUsers({\r\n      query: debouncedUserSearch,\r\n      page: 1,\r\n      limit: 5,\r\n    });\r\n  const searchResults = searchResultsData?.users || searchResultsData || [];\r\n\r\n  // Handle Deep Linking / Sync Route\r\n  useEffect(() => {\r\n    const handleSync = async () => {\r\n      if (!conversationId || conversationId === 'messages') return;\r\n\r\n      const existing = conversations.find(\r\n        c =>\r\n          c._id === conversationId ||\r\n          c.conversationId === conversationId ||\r\n          c.id === conversationId ||\r\n          c.directId === conversationId\r\n      );\r\n\r\n      if (\r\n        existing &&\r\n        conversationId.includes('_') &&\r\n        existing._id &&\r\n        existing._id !== conversationId\r\n      ) {\r\n        navigate(`/messages/${existing._id}`, { replace: true });\r\n        return;\r\n      }\r\n\r\n      if (!existing && !conversationsLoading) {\r\n        // Match user1Id_user2Id format\r\n        const pairMatch = conversationId.match(\r\n          /^([a-f\\d]{24})_([a-f\\d]{24})$/i\r\n        );\r\n        if (pairMatch) {\r\n          const [_, u1, u2] = pairMatch;\r\n          const targetId = u1 === user?._id ? u2 : u1;\r\n          if (targetId) {\r\n            try {\r\n              const conv = await createConversationMutation.mutateAsync(\r\n                targetId\r\n              );\r\n              if (conv?._id && conv?._id !== conversationId) {\r\n                navigate(`/messages/${conv._id}`, { replace: true });\r\n              }\r\n            } catch (err) {\r\n              console.error('Failed to create/fetch conversation by pair', err);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    if (user) handleSync();\r\n  }, [\r\n    conversationId,\r\n    conversations,\r\n    user,\r\n    conversationsLoading,\r\n    navigate,\r\n    createConversationMutation,\r\n  ]);\r\n\r\n  const filteredConversations = useMemo(() => {\r\n    if (!Array.isArray(conversations)) return [];\r\n    return conversations.filter(c => {\r\n      const otherUser =\r\n        c.otherUser ||\r\n        c.participant ||\r\n        c.members?.find(m => m._id !== user?._id);\r\n      const name = c.isGroup\r\n        ? c.name || 'Nh√≥m'\r\n        : otherUser?.name || otherUser?.fullName || otherUser?.username || '';\r\n      return name.toLowerCase().includes(searchQuery.toLowerCase());\r\n    });\r\n  }, [conversations, searchQuery, user?._id]);\r\n\r\n  const handleCreateGroup = async () => {\r\n    if (!groupName.trim() || selectedUsers.length < 2) return;\r\n    try {\r\n      const newGroup = await createGroupMutation.mutateAsync({\r\n        name: groupName,\r\n        participantIds: selectedUsers.map(u => u._id),\r\n      });\r\n\r\n      setShowGroupModal(false);\r\n      setGroupName('');\r\n      setSelectedUsers([]);\r\n      navigate(`/messages/${newGroup._id || newGroup.id}`);\r\n    } catch (error) {\r\n      console.error('Failed to create group:', error);\r\n    }\r\n  };\r\n\r\n  const toggleUserSelection = user => {\r\n    if (selectedUsers.find(u => u._id === user._id)) {\r\n      setSelectedUsers(selectedUsers.filter(u => u._id !== user._id));\r\n    } else {\r\n      setSelectedUsers([...selectedUsers, user]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex w-full h-[calc(100vh-4rem)] md:h-screen bg-transparent overflow-hidden\">\r\n      {/* Left Sidebar (Conversation List) */}\r\n      <div\r\n        className={`w-full md:w-[380px] lg:w-[400px] flex-shrink-0 border-r border-border flex flex-col bg-background transition-all ${\r\n          conversationId ? 'hidden md:flex' : 'flex'\r\n        }`}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"p-5 border-b border-border\">\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <h1 className=\"text-2xl font-black text-content tracking-tight\">\r\n              Tin nh·∫Øn\r\n            </h1>\r\n            <div className=\"flex items-center gap-1\">\r\n              <button\r\n                onClick={() => setShowGroupModal(true)}\r\n                className=\"yb-btn-ghost p-2.5 rounded-full transition-all text-secondary hover:text-primary\"\r\n                title=\"T·∫°o nh√≥m chat\"\r\n              >\r\n                <Users size={22} />\r\n              </button>\r\n              <button className=\"yb-btn-ghost p-2.5 rounded-full transition-all text-secondary hover:text-primary\">\r\n                <Settings size={22} />\r\n              </button>\r\n            </div>\r\n          </div>\r\n          {/* Search */}\r\n          <div className=\"relative group\">\r\n            <Search\r\n              size={18}\r\n              className=\"absolute left-4 top-1/2 -translate-y-1/2 text-text-tertiary group-focus-within:text-primary transition-colors\"\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              value={searchQuery}\r\n              onChange={e => setSearchQuery(e.target.value)}\r\n              placeholder=\"T√¨m ki·∫øm cu·ªôc tr√≤ chuy·ªán...\"\r\n              className=\"w-full pl-11 pr-4 py-3 rounded-2xl bg-surface-secondary text-content border border-transparent focus:border-border-focus placeholder:text-text-tertiary text-sm focus:outline-none transition-all duration-300\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Conversations List */}\r\n        <div className=\"flex-1 overflow-y-auto custom-scrollbar pb-20 md:pb-0\">\r\n          {conversationsLoading && conversations.length === 0 ? (\r\n            <div className=\"flex flex-col items-center justify-center py-12 space-y-4\">\r\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n              <p className=\"text-xs text-text-tertiary font-medium\">\r\n                ƒêang t·∫£i cu·ªôc tr√≤ chuy·ªán...\r\n              </p>\r\n            </div>\r\n          ) : filteredConversations.length === 0 ? (\r\n            <div className=\"p-10 text-center flex flex-col items-center justify-center space-y-4\">\r\n              <div className=\"w-16 h-16 bg-surface-secondary rounded-3xl flex items-center justify-center border border-border\">\r\n                <MessageCircle size={32} className=\"text-text-tertiary\" />\r\n              </div>\r\n              <p className=\"text-text-tertiary text-sm font-medium\">\r\n                {searchQuery\r\n                  ? 'Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£'\r\n                  : 'Ch∆∞a c√≥ cu·ªôc tr√≤ chuy·ªán n√†o'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"\">\r\n              {filteredConversations.map(conversation => {\r\n                const id =\r\n                  conversation._id ||\r\n                  conversation.conversationId ||\r\n                  conversation.id;\r\n                return (\r\n                  <ConversationItem\r\n                    key={id}\r\n                    conversation={conversation}\r\n                    isActive={\r\n                      !!conversationId &&\r\n                      (conversationId === id ||\r\n                        conversation.directId === conversationId)\r\n                    }\r\n                    onClick={() => navigate(`/messages/${id}`)}\r\n                    currentUserId={user?._id}\r\n                  />\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right Content Area (Rendered via Outlet) */}\r\n      <div\r\n        className={`flex-1 min-w-0 bg-background flex flex-col ${\r\n          conversationId ? 'flex' : 'hidden md:flex'\r\n        }`}\r\n      >\r\n        <Outlet />\r\n      </div>\r\n\r\n      {/* Create Group Modal */}\r\n      <CreateGroupModal\r\n        isOpen={showGroupModal}\r\n        onClose={() => setShowGroupModal(false)}\r\n        groupName={groupName}\r\n        setGroupName={setGroupName}\r\n        searchQuery={userSearchTerm}\r\n        onSearchChange={setUserSearchTerm}\r\n        searchResults={searchResults}\r\n        selectedUsers={selectedUsers}\r\n        onToggleUser={toggleUserSelection}\r\n        isSearching={isSearchingUsers}\r\n        onSubmit={handleCreateGroup}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Message;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\Notifications.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\pages\\UserPage\\UserLayout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\redux\\actions\\authActions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\redux\\slices\\AuthSlice.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'action' is defined but never used.","line":138,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":138,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"action"},"fix":{"range":[4016,4024],"text":""},"desc":"Remove unused variable 'action'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createSlice } from '@reduxjs/toolkit';\r\nimport {\r\n  login,\r\n  register,\r\n  googleAuth,\r\n  logout,\r\n  logoutAll,\r\n  updatePassword,\r\n  requestPasswordReset,\r\n  resetPassword,\r\n  enable2FA,\r\n  verify2FA,\r\n  disable2FA,\r\n  getSessions,\r\n  revokeSession,\r\n} from '@/redux/actions/authActions';\r\n\r\nconst initialState = {\r\n  user: null,\r\n  isAuthenticated: false,\r\n  loading: false,\r\n  error: null,\r\n  sessions: [],\r\n  twoFactorEnabled: false,\r\n  twoFactorPending: false,\r\n};\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    clearError: state => {\r\n      state.error = null;\r\n    },\r\n    setUser: (state, action) => {\r\n      state.user = action.payload;\r\n      state.isAuthenticated = !!action.payload;\r\n    },\r\n    setIsAuthenticated: (state, action) => {\r\n      state.isAuthenticated = action.payload;\r\n    },\r\n    updateUserProfile: (state, action) => {\r\n      if (state.user) {\r\n        state.user = { ...state.user, ...action.payload };\r\n      }\r\n    },\r\n    resetAuthState: () => initialState,\r\n  },\r\n  extraReducers: builder => {\r\n    builder\r\n      // Login\r\n      .addCase(login.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(login.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.user = action.payload;\r\n        state.isAuthenticated = true;\r\n        state.twoFactorEnabled = action.payload?.twoFactorEnabled || false;\r\n      })\r\n      .addCase(login.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Register\r\n      .addCase(register.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(register.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.user = action.payload;\r\n        state.isAuthenticated = true;\r\n      })\r\n      .addCase(register.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Google Auth\r\n      .addCase(googleAuth.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(googleAuth.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.user = action.payload;\r\n        state.isAuthenticated = true;\r\n      })\r\n      .addCase(googleAuth.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Logout\r\n      .addCase(logout.fulfilled, () => initialState)\r\n      .addCase(logout.rejected, () => initialState)\r\n      .addCase(logoutAll.fulfilled, () => initialState)\r\n      // Update Password\r\n      .addCase(updatePassword.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(updatePassword.fulfilled, state => {\r\n        state.loading = false;\r\n      })\r\n      .addCase(updatePassword.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Password Reset Request\r\n      .addCase(requestPasswordReset.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(requestPasswordReset.fulfilled, state => {\r\n        state.loading = false;\r\n      })\r\n      .addCase(requestPasswordReset.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Reset Password\r\n      .addCase(resetPassword.pending, state => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(resetPassword.fulfilled, state => {\r\n        state.loading = false;\r\n      })\r\n      .addCase(resetPassword.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // 2FA Enable\r\n      .addCase(enable2FA.pending, state => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(enable2FA.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.twoFactorPending = true;\r\n      })\r\n      .addCase(enable2FA.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // 2FA Verify\r\n      .addCase(verify2FA.pending, state => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(verify2FA.fulfilled, state => {\r\n        state.loading = false;\r\n        state.twoFactorEnabled = true;\r\n        state.twoFactorPending = false;\r\n      })\r\n      .addCase(verify2FA.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // 2FA Disable\r\n      .addCase(disable2FA.fulfilled, state => {\r\n        state.twoFactorEnabled = false;\r\n      })\r\n      // Sessions\r\n      .addCase(getSessions.fulfilled, (state, action) => {\r\n        // Handle { sessions } or direct array\r\n        state.sessions =\r\n          action.payload?.sessions ||\r\n          (Array.isArray(action.payload) ? action.payload : []);\r\n      })\r\n      .addCase(revokeSession.fulfilled, (state, action) => {\r\n        state.sessions = state.sessions.filter(\r\n          session => session.id !== action.payload.sessionId\r\n        );\r\n      });\r\n  },\r\n});\r\n\r\nexport const {\r\n  clearError,\r\n  setUser,\r\n  setIsAuthenticated,\r\n  updateUserProfile,\r\n  resetAuthState,\r\n} = authSlice.actions;\r\nexport default authSlice.reducer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\redux\\store.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\apiUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\commentUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\dateUtils.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'options' is assigned a value but never used.","line":10,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[376,390],"text":""},"desc":"Remove unused variable 'options'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Format date to relative time string (Vietnamese)\r\n * @param {Date|string} date - Date to format\r\n * @param {Object} [options] - Format options\r\n * @returns {string} Relative time string\r\n * @example\r\n * formatDistanceToNow(new Date()) // \"v·ª´a xong\"\r\n * formatDistanceToNow(new Date(Date.now() - 3600000)) // \"1 gi·ªù tr∆∞·ªõc\"\r\n */\r\nexport const formatDistanceToNow = (date, options = {}) => {\r\n  if (!date) return '';\r\n\r\n  const now = new Date();\r\n  const past = new Date(date);\r\n  const diffInSeconds = Math.floor((now - past) / 1000);\r\n\r\n  if (diffInSeconds < 60) return 'v·ª´a xong';\r\n  if (diffInSeconds < 3600)\r\n    return `${Math.floor(diffInSeconds / 60)} ph√∫t tr∆∞·ªõc`;\r\n  if (diffInSeconds < 86400)\r\n    return `${Math.floor(diffInSeconds / 3600)} gi·ªù tr∆∞·ªõc`;\r\n  if (diffInSeconds < 604800)\r\n    return `${Math.floor(diffInSeconds / 86400)} ng√†y tr∆∞·ªõc`;\r\n  if (diffInSeconds < 2592000)\r\n    return `${Math.floor(diffInSeconds / 604800)} tu·∫ßn tr∆∞·ªõc`;\r\n  if (diffInSeconds < 31536000)\r\n    return `${Math.floor(diffInSeconds / 2592000)} th√°ng tr∆∞·ªõc`;\r\n\r\n  return `${Math.floor(diffInSeconds / 31536000)} nƒÉm tr∆∞·ªõc`;\r\n};\r\n\r\n/**\r\n * Format distance between two dates\r\n * @param {Date|string} date - Target date\r\n * @param {Date|string} baseDate - Base date for comparison\r\n * @param {Object} [options] - Format options\r\n * @returns {string} Relative time string\r\n */\r\nexport const formatDistance = (date, baseDate, options = {}) => {\r\n  return formatDistanceToNow(date, options);\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\formatTime.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\interactionUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\notificationUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\numberUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\postUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\src\\utils\\reportUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\cyhin\\YiBu\\client\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]